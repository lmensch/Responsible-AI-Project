{"metadata":{"kernelspec":{"name":"python3","display_name":"Python 3","language":"python"},"language_info":{"name":"python","version":"3.11.13","mimetype":"text/x-python","codemirror_mode":{"name":"ipython","version":3},"pygments_lexer":"ipython3","nbconvert_exporter":"python","file_extension":".py"},"colab":{"provenance":[],"gpuType":"T4"},"accelerator":"GPU","widgets":{"application/vnd.jupyter.widget-state+json":{"d48821551c014f97a493ac0707f2ef1b":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_4d1573a261044ba2a115f4c15e265746","IPY_MODEL_15bf25a36a8d45399482b590b7dfd877","IPY_MODEL_04d30eef27954f128af69c1c1ece175b"],"layout":"IPY_MODEL_48c66001538f4bf3a8e37656d68a94e0"}},"4d1573a261044ba2a115f4c15e265746":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_f67195f352fc4f0899d6c75aff2302cd","placeholder":"​","style":"IPY_MODEL_ed62e7076d0c42f5b811dfc6cad8a18a","value":"tokenizer_config.json: "}},"15bf25a36a8d45399482b590b7dfd877":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"success","description":"","description_tooltip":null,"layout":"IPY_MODEL_bb4abc2825674c36ba74015487c7e898","max":1,"min":0,"orientation":"horizontal","style":"IPY_MODEL_242d4a35ccc144ce878ad35098e02b9f","value":1}},"04d30eef27954f128af69c1c1ece175b":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_19df4a4ba32248e49e2ea5c0b562d53f","placeholder":"​","style":"IPY_MODEL_774e1f1dbdbf499aa28407ffe1576ea4","value":" 3.44k/? [00:00&lt;00:00, 286kB/s]"}},"48c66001538f4bf3a8e37656d68a94e0":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"f67195f352fc4f0899d6c75aff2302cd":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"ed62e7076d0c42f5b811dfc6cad8a18a":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"bb4abc2825674c36ba74015487c7e898":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":"20px"}},"242d4a35ccc144ce878ad35098e02b9f":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"19df4a4ba32248e49e2ea5c0b562d53f":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"774e1f1dbdbf499aa28407ffe1576ea4":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"de7d797080b5478883be61fce42c601e":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_903428baee6541d78478edca36598391","IPY_MODEL_5e1a970b6b73449ab18f7fb841047f17","IPY_MODEL_cae1bf97eae645d58a83d56c29cf484c"],"layout":"IPY_MODEL_714b3363905d465e80f4c4171fe97fee"}},"903428baee6541d78478edca36598391":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_10bbc301c724473e94741c365d2ff07b","placeholder":"​","style":"IPY_MODEL_0e1e31e7ab4b4284aae08ad7d6cdb260","value":"tokenizer.model: 100%"}},"5e1a970b6b73449ab18f7fb841047f17":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"success","description":"","description_tooltip":null,"layout":"IPY_MODEL_8e6a771dd5794c8ba22620f3d749505a","max":499723,"min":0,"orientation":"horizontal","style":"IPY_MODEL_5c29e69b064540b0b63efceb56a7491a","value":499723}},"cae1bf97eae645d58a83d56c29cf484c":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_f0fc6b6d35384e23ae32edac9a8aa6fa","placeholder":"​","style":"IPY_MODEL_fab631614fb64255ace70931480bbb55","value":" 500k/500k [00:00&lt;00:00, 852kB/s]"}},"714b3363905d465e80f4c4171fe97fee":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"10bbc301c724473e94741c365d2ff07b":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"0e1e31e7ab4b4284aae08ad7d6cdb260":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"8e6a771dd5794c8ba22620f3d749505a":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"5c29e69b064540b0b63efceb56a7491a":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"f0fc6b6d35384e23ae32edac9a8aa6fa":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"fab631614fb64255ace70931480bbb55":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"34b66300f62a4bc7ae474ea539c3f497":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_11c94c97d2764ac781a29d6f43aa5913","IPY_MODEL_6900ae5deb5e46dbb0f3d5872e213187","IPY_MODEL_bf2c41bb3923465a803a8c7835449e28"],"layout":"IPY_MODEL_d491abf4577846b08889644f9c38f236"}},"11c94c97d2764ac781a29d6f43aa5913":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_40a2ff4baa4d485ea61b7836b0eec20c","placeholder":"​","style":"IPY_MODEL_3bd25520d0f54cb2aaad2498f84a5f8f","value":"tokenizer.json: "}},"6900ae5deb5e46dbb0f3d5872e213187":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"success","description":"","description_tooltip":null,"layout":"IPY_MODEL_2a66449aa2314e71bd3184490e3c6b98","max":1,"min":0,"orientation":"horizontal","style":"IPY_MODEL_9018b519e88f4e648b71ee89f77b556f","value":1}},"bf2c41bb3923465a803a8c7835449e28":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_5980c39a929f4084bfe450a45b7fffb8","placeholder":"​","style":"IPY_MODEL_0bce57e429b242a88d5de3a3f271e06f","value":" 1.94M/? [00:00&lt;00:00, 20.6MB/s]"}},"d491abf4577846b08889644f9c38f236":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"40a2ff4baa4d485ea61b7836b0eec20c":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"3bd25520d0f54cb2aaad2498f84a5f8f":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"2a66449aa2314e71bd3184490e3c6b98":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":"20px"}},"9018b519e88f4e648b71ee89f77b556f":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"5980c39a929f4084bfe450a45b7fffb8":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"0bce57e429b242a88d5de3a3f271e06f":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"47ea0961eb81408b9fa485c0b14ec107":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_980a2d419e554c31a0a5956289848e10","IPY_MODEL_d3e71c4cb5204d7087f3c02e88a2c5de","IPY_MODEL_ecc6a1dafa4447f0a4ed43aec36c7b4e"],"layout":"IPY_MODEL_f443db8651fa43ee8db38ef2bab344f3"}},"980a2d419e554c31a0a5956289848e10":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_82baf676576e4185ad21598232dca938","placeholder":"​","style":"IPY_MODEL_62bfb04d0b5041f7ba05e40b9f83b258","value":"added_tokens.json: 100%"}},"d3e71c4cb5204d7087f3c02e88a2c5de":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"success","description":"","description_tooltip":null,"layout":"IPY_MODEL_e9799af286cb4281bd31da3cbf356a3a","max":306,"min":0,"orientation":"horizontal","style":"IPY_MODEL_db1b0a00826d41f8a50f03880d5b06a9","value":306}},"ecc6a1dafa4447f0a4ed43aec36c7b4e":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_c74797143aab4579ae62c0b5ba8b20eb","placeholder":"​","style":"IPY_MODEL_3e3a74be701d453b8e61b3b65fffb876","value":" 306/306 [00:00&lt;00:00, 31.1kB/s]"}},"f443db8651fa43ee8db38ef2bab344f3":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"82baf676576e4185ad21598232dca938":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"62bfb04d0b5041f7ba05e40b9f83b258":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"e9799af286cb4281bd31da3cbf356a3a":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"db1b0a00826d41f8a50f03880d5b06a9":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"c74797143aab4579ae62c0b5ba8b20eb":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"3e3a74be701d453b8e61b3b65fffb876":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"46c654ba13a64383bec7d09fe94cfd28":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_49b6b3dcec0740e9a759071e77cb5cff","IPY_MODEL_725992a963d446d199de755ab4a5342c","IPY_MODEL_ffc12cf58c09477080f3a2fe917aeee9"],"layout":"IPY_MODEL_87b8b334d71e4ac6adc12745574b78f4"}},"49b6b3dcec0740e9a759071e77cb5cff":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_a737263563c042ce84a948f1fa4eb9b7","placeholder":"​","style":"IPY_MODEL_ff0d426873b240dcaf3e7d802b99cf2c","value":"special_tokens_map.json: 100%"}},"725992a963d446d199de755ab4a5342c":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"success","description":"","description_tooltip":null,"layout":"IPY_MODEL_3a48aa8fee704598b94aaddc4e85472c","max":599,"min":0,"orientation":"horizontal","style":"IPY_MODEL_c9f536c020ad487aa78d8ccaa7ae2fbe","value":599}},"ffc12cf58c09477080f3a2fe917aeee9":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_dafef56162a1471ab2f2ba094eb9b35b","placeholder":"​","style":"IPY_MODEL_b5e4188d51684e0493b581a9ee049446","value":" 599/599 [00:00&lt;00:00, 53.7kB/s]"}},"87b8b334d71e4ac6adc12745574b78f4":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"a737263563c042ce84a948f1fa4eb9b7":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"ff0d426873b240dcaf3e7d802b99cf2c":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"3a48aa8fee704598b94aaddc4e85472c":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"c9f536c020ad487aa78d8ccaa7ae2fbe":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"dafef56162a1471ab2f2ba094eb9b35b":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"b5e4188d51684e0493b581a9ee049446":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"4ffb60b972954084a8391ee438ca486c":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_5299c2ff5ef54f36a2d8cab4703b2275","IPY_MODEL_38a3c4111d5744dea4a3ab186f401b3a","IPY_MODEL_18c753a48eab4fff8756352d99f8acf7"],"layout":"IPY_MODEL_f446de346dd54415932350330c58845c"}},"5299c2ff5ef54f36a2d8cab4703b2275":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_080a6b8126ae4f53bb4ec3e958e63ab0","placeholder":"​","style":"IPY_MODEL_441f815690f042a8a2c556b0d52fb7c2","value":"config.json: 100%"}},"38a3c4111d5744dea4a3ab186f401b3a":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"success","description":"","description_tooltip":null,"layout":"IPY_MODEL_f17d3956a4f34b03b704e4926df95f81","max":967,"min":0,"orientation":"horizontal","style":"IPY_MODEL_9c73493fa38a4031ab692823240a516f","value":967}},"18c753a48eab4fff8756352d99f8acf7":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_6b299985a23f47848070467842c67bc6","placeholder":"​","style":"IPY_MODEL_d4d07cac643443aa94ee15c579b58571","value":" 967/967 [00:00&lt;00:00, 97.4kB/s]"}},"f446de346dd54415932350330c58845c":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"080a6b8126ae4f53bb4ec3e958e63ab0":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"441f815690f042a8a2c556b0d52fb7c2":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"f17d3956a4f34b03b704e4926df95f81":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"9c73493fa38a4031ab692823240a516f":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"6b299985a23f47848070467842c67bc6":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"d4d07cac643443aa94ee15c579b58571":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"717c10e81b224dc1ac75648b14f3bac3":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_763ae03d07db453a8e712b9e30f1548e","IPY_MODEL_91c1b3d8527e4ef193a84e86e8051c1e","IPY_MODEL_a7370348e376472f8821deed8e5e4071"],"layout":"IPY_MODEL_f7125aab93bf4964817566798b6671b7"}},"763ae03d07db453a8e712b9e30f1548e":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_aa5e9f39114f4b709bda0e64a59a6c90","placeholder":"​","style":"IPY_MODEL_fcabacfbbfba405aa2955bf08967b39e","value":"model.safetensors.index.json: "}},"91c1b3d8527e4ef193a84e86e8051c1e":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"success","description":"","description_tooltip":null,"layout":"IPY_MODEL_d8b58cadd60a4a60b7f3a78a1c19856b","max":1,"min":0,"orientation":"horizontal","style":"IPY_MODEL_e7d9ed04f56448829e558966deefd0d2","value":1}},"a7370348e376472f8821deed8e5e4071":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_89d89c13c7364df3a32f50871914788e","placeholder":"​","style":"IPY_MODEL_4c614e3185b043929c6903b9854b267b","value":" 16.5k/? [00:00&lt;00:00, 1.38MB/s]"}},"f7125aab93bf4964817566798b6671b7":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"aa5e9f39114f4b709bda0e64a59a6c90":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"fcabacfbbfba405aa2955bf08967b39e":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"d8b58cadd60a4a60b7f3a78a1c19856b":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":"20px"}},"e7d9ed04f56448829e558966deefd0d2":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"89d89c13c7364df3a32f50871914788e":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"4c614e3185b043929c6903b9854b267b":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"d79125cf539349649f228e47b1d520e6":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_f51c1c0deeb14c968e85d8db090d8ff6","IPY_MODEL_bebaca40fce34daba61b4fb8f825eaf9","IPY_MODEL_f0a7a686b97d462082efd6e6eef468e4"],"layout":"IPY_MODEL_351b74c4783d4149a696999776aa46ed"}},"f51c1c0deeb14c968e85d8db090d8ff6":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_042719b2034949108ec1e45048b6c765","placeholder":"​","style":"IPY_MODEL_8c570bee343d475682c6ed774e756b0b","value":"Fetching 2 files: 100%"}},"bebaca40fce34daba61b4fb8f825eaf9":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"success","description":"","description_tooltip":null,"layout":"IPY_MODEL_beaee0139f044f989cf1f1ee01b215d7","max":2,"min":0,"orientation":"horizontal","style":"IPY_MODEL_5b24d9dc09a64e1284554940f1012270","value":2}},"f0a7a686b97d462082efd6e6eef468e4":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_5c367f4175d043dab6a02d8f4a002323","placeholder":"​","style":"IPY_MODEL_dd517482d0a74407b9ba1e0d7a39dafc","value":" 2/2 [08:30&lt;00:00, 210.09s/it]"}},"351b74c4783d4149a696999776aa46ed":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"042719b2034949108ec1e45048b6c765":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"8c570bee343d475682c6ed774e756b0b":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"beaee0139f044f989cf1f1ee01b215d7":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"5b24d9dc09a64e1284554940f1012270":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"5c367f4175d043dab6a02d8f4a002323":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"dd517482d0a74407b9ba1e0d7a39dafc":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"298cb46504ed409e955fef722227f561":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_a07b36ebc60b4c588d7870c4adcd7757","IPY_MODEL_7b1a928c35d64d61999169796d95b178","IPY_MODEL_59bf5a3c9aa541d0a3a88ac68880c5b4"],"layout":"IPY_MODEL_c138cb89049c4a2c87bed355da2ccf3d"}},"a07b36ebc60b4c588d7870c4adcd7757":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_f9a78f6d498f49f79322cf0ecd374bf0","placeholder":"​","style":"IPY_MODEL_59fda5e2256c4e2489b27af555710bfe","value":"model-00001-of-00002.safetensors: 100%"}},"7b1a928c35d64d61999169796d95b178":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"success","description":"","description_tooltip":null,"layout":"IPY_MODEL_b80fe94d5af74272a9a36fd8149662a8","max":4972489328,"min":0,"orientation":"horizontal","style":"IPY_MODEL_0db3e5859e2b4047b5c03d369821b3f4","value":4972489328}},"59bf5a3c9aa541d0a3a88ac68880c5b4":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_f87d5b38ebe345a6905b61e73222de60","placeholder":"​","style":"IPY_MODEL_4f92eae8b15642b2a84c8b391d9b0d39","value":" 4.97G/4.97G [08:28&lt;00:00, 28.7MB/s]"}},"c138cb89049c4a2c87bed355da2ccf3d":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"f9a78f6d498f49f79322cf0ecd374bf0":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"59fda5e2256c4e2489b27af555710bfe":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"b80fe94d5af74272a9a36fd8149662a8":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"0db3e5859e2b4047b5c03d369821b3f4":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"f87d5b38ebe345a6905b61e73222de60":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"4f92eae8b15642b2a84c8b391d9b0d39":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"1498f049d2274780b83186a07e82fed6":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_77cf943557ba41079cc66b7986ed8ade","IPY_MODEL_84fe917bb05e49c5b618c80b38973579","IPY_MODEL_4fd359e5407045948f965ece72f499bc"],"layout":"IPY_MODEL_1174b2cdf36f4bdbb092c58756b29b59"}},"77cf943557ba41079cc66b7986ed8ade":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_c21b62145dc44661b01dc155227480db","placeholder":"​","style":"IPY_MODEL_ac9c3205472548339004c21d7e899645","value":"model-00002-of-00002.safetensors: 100%"}},"84fe917bb05e49c5b618c80b38973579":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"success","description":"","description_tooltip":null,"layout":"IPY_MODEL_7ccdabbebbf44c7bbc3c73986940c16b","max":2669692552,"min":0,"orientation":"horizontal","style":"IPY_MODEL_00515f80cdee4347ab1dc8cda9efe52d","value":2669692552}},"4fd359e5407045948f965ece72f499bc":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_5c92e3429f8b4ac19277b6bd1003d0e1","placeholder":"​","style":"IPY_MODEL_1bf10d404c8c4f6183958fbec8ed1d03","value":" 2.67G/2.67G [08:29&lt;00:00, 13.1MB/s]"}},"1174b2cdf36f4bdbb092c58756b29b59":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"c21b62145dc44661b01dc155227480db":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"ac9c3205472548339004c21d7e899645":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"7ccdabbebbf44c7bbc3c73986940c16b":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"00515f80cdee4347ab1dc8cda9efe52d":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"5c92e3429f8b4ac19277b6bd1003d0e1":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"1bf10d404c8c4f6183958fbec8ed1d03":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"320d5c625c704dc89815e772409b4b95":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_579e56bf3afb4e8aa60dc262741643da","IPY_MODEL_6e50d022302748828c3626f7cf970d3a","IPY_MODEL_8d6e359c1ae74e97a2073283d0ce7407"],"layout":"IPY_MODEL_7cf6622e557b4a2ab1bb9a37b6e0017c"}},"579e56bf3afb4e8aa60dc262741643da":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_aa1316443956406b980dff1f1553131e","placeholder":"​","style":"IPY_MODEL_5ff8502416404c17baa9dab137e2fd43","value":"Loading checkpoint shards: 100%"}},"6e50d022302748828c3626f7cf970d3a":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"success","description":"","description_tooltip":null,"layout":"IPY_MODEL_8fbad883a0b44695bf4a294ca913f83c","max":2,"min":0,"orientation":"horizontal","style":"IPY_MODEL_844c19358d7048dfb76607443d5d960b","value":2}},"8d6e359c1ae74e97a2073283d0ce7407":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_80a35aa9490f48e98e38afeb2712008f","placeholder":"​","style":"IPY_MODEL_175e528b63b5448eaa69343a580f9a48","value":" 2/2 [00:30&lt;00:00, 14.55s/it]"}},"7cf6622e557b4a2ab1bb9a37b6e0017c":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"aa1316443956406b980dff1f1553131e":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"5ff8502416404c17baa9dab137e2fd43":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"8fbad883a0b44695bf4a294ca913f83c":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"844c19358d7048dfb76607443d5d960b":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"80a35aa9490f48e98e38afeb2712008f":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"175e528b63b5448eaa69343a580f9a48":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"8a467bc5a5f041229ceb030b2ee69d52":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_e8d4fae94894451da732490f5e87abab","IPY_MODEL_c0cc3e2c21084b81a02e9302c16d9375","IPY_MODEL_31ef1070ce564dd0b6491a60030d10a0"],"layout":"IPY_MODEL_8b4c6f9ff4e64d79aae4e845d205df6e"}},"e8d4fae94894451da732490f5e87abab":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_d7b8e6802645450d814d50bfe8914ca1","placeholder":"​","style":"IPY_MODEL_c8e6847b569941bf8f35cf1c46826058","value":"generation_config.json: 100%"}},"c0cc3e2c21084b81a02e9302c16d9375":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"success","description":"","description_tooltip":null,"layout":"IPY_MODEL_a17c76d7cf3e4e3caf417f9f8050b68f","max":181,"min":0,"orientation":"horizontal","style":"IPY_MODEL_8366b2777c2744feb8c976d87c637bfb","value":181}},"31ef1070ce564dd0b6491a60030d10a0":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_386ed221cd3e499382d5ab49fe015370","placeholder":"​","style":"IPY_MODEL_7153f18f59ec4e15b847714d741ad2d6","value":" 181/181 [00:00&lt;00:00, 13.4kB/s]"}},"8b4c6f9ff4e64d79aae4e845d205df6e":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"d7b8e6802645450d814d50bfe8914ca1":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"c8e6847b569941bf8f35cf1c46826058":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"a17c76d7cf3e4e3caf417f9f8050b68f":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"8366b2777c2744feb8c976d87c637bfb":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"386ed221cd3e499382d5ab49fe015370":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"7153f18f59ec4e15b847714d741ad2d6":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}}}},"kaggle":{"accelerator":"nvidiaTeslaT4","dataSources":[],"dockerImageVersionId":31090,"isInternetEnabled":true,"language":"python","sourceType":"notebook","isGpuEnabled":true}},"nbformat_minor":4,"nbformat":4,"cells":[{"cell_type":"code","source":"from transformers import AutoModelForCausalLM, AutoTokenizer, set_seed\n\nset_seed(42)\n\nmodel_name = \"Qwen/Qwen3-4B\"\n\n# load the tokenizer and the model\ntokenizer = AutoTokenizer.from_pretrained(model_name)\nmodel = AutoModelForCausalLM.from_pretrained(\n    model_name,\n    torch_dtype=\"auto\",\n    device_map=\"auto\"\n)","metadata":{"colab":{"base_uri":"https://localhost:8080/","height":401,"referenced_widgets":["d48821551c014f97a493ac0707f2ef1b","4d1573a261044ba2a115f4c15e265746","15bf25a36a8d45399482b590b7dfd877","04d30eef27954f128af69c1c1ece175b","48c66001538f4bf3a8e37656d68a94e0","f67195f352fc4f0899d6c75aff2302cd","ed62e7076d0c42f5b811dfc6cad8a18a","bb4abc2825674c36ba74015487c7e898","242d4a35ccc144ce878ad35098e02b9f","19df4a4ba32248e49e2ea5c0b562d53f","774e1f1dbdbf499aa28407ffe1576ea4","de7d797080b5478883be61fce42c601e","903428baee6541d78478edca36598391","5e1a970b6b73449ab18f7fb841047f17","cae1bf97eae645d58a83d56c29cf484c","714b3363905d465e80f4c4171fe97fee","10bbc301c724473e94741c365d2ff07b","0e1e31e7ab4b4284aae08ad7d6cdb260","8e6a771dd5794c8ba22620f3d749505a","5c29e69b064540b0b63efceb56a7491a","f0fc6b6d35384e23ae32edac9a8aa6fa","fab631614fb64255ace70931480bbb55","34b66300f62a4bc7ae474ea539c3f497","11c94c97d2764ac781a29d6f43aa5913","6900ae5deb5e46dbb0f3d5872e213187","bf2c41bb3923465a803a8c7835449e28","d491abf4577846b08889644f9c38f236","40a2ff4baa4d485ea61b7836b0eec20c","3bd25520d0f54cb2aaad2498f84a5f8f","2a66449aa2314e71bd3184490e3c6b98","9018b519e88f4e648b71ee89f77b556f","5980c39a929f4084bfe450a45b7fffb8","0bce57e429b242a88d5de3a3f271e06f","47ea0961eb81408b9fa485c0b14ec107","980a2d419e554c31a0a5956289848e10","d3e71c4cb5204d7087f3c02e88a2c5de","ecc6a1dafa4447f0a4ed43aec36c7b4e","f443db8651fa43ee8db38ef2bab344f3","82baf676576e4185ad21598232dca938","62bfb04d0b5041f7ba05e40b9f83b258","e9799af286cb4281bd31da3cbf356a3a","db1b0a00826d41f8a50f03880d5b06a9","c74797143aab4579ae62c0b5ba8b20eb","3e3a74be701d453b8e61b3b65fffb876","46c654ba13a64383bec7d09fe94cfd28","49b6b3dcec0740e9a759071e77cb5cff","725992a963d446d199de755ab4a5342c","ffc12cf58c09477080f3a2fe917aeee9","87b8b334d71e4ac6adc12745574b78f4","a737263563c042ce84a948f1fa4eb9b7","ff0d426873b240dcaf3e7d802b99cf2c","3a48aa8fee704598b94aaddc4e85472c","c9f536c020ad487aa78d8ccaa7ae2fbe","dafef56162a1471ab2f2ba094eb9b35b","b5e4188d51684e0493b581a9ee049446","4ffb60b972954084a8391ee438ca486c","5299c2ff5ef54f36a2d8cab4703b2275","38a3c4111d5744dea4a3ab186f401b3a","18c753a48eab4fff8756352d99f8acf7","f446de346dd54415932350330c58845c","080a6b8126ae4f53bb4ec3e958e63ab0","441f815690f042a8a2c556b0d52fb7c2","f17d3956a4f34b03b704e4926df95f81","9c73493fa38a4031ab692823240a516f","6b299985a23f47848070467842c67bc6","d4d07cac643443aa94ee15c579b58571","717c10e81b224dc1ac75648b14f3bac3","763ae03d07db453a8e712b9e30f1548e","91c1b3d8527e4ef193a84e86e8051c1e","a7370348e376472f8821deed8e5e4071","f7125aab93bf4964817566798b6671b7","aa5e9f39114f4b709bda0e64a59a6c90","fcabacfbbfba405aa2955bf08967b39e","d8b58cadd60a4a60b7f3a78a1c19856b","e7d9ed04f56448829e558966deefd0d2","89d89c13c7364df3a32f50871914788e","4c614e3185b043929c6903b9854b267b","d79125cf539349649f228e47b1d520e6","f51c1c0deeb14c968e85d8db090d8ff6","bebaca40fce34daba61b4fb8f825eaf9","f0a7a686b97d462082efd6e6eef468e4","351b74c4783d4149a696999776aa46ed","042719b2034949108ec1e45048b6c765","8c570bee343d475682c6ed774e756b0b","beaee0139f044f989cf1f1ee01b215d7","5b24d9dc09a64e1284554940f1012270","5c367f4175d043dab6a02d8f4a002323","dd517482d0a74407b9ba1e0d7a39dafc","298cb46504ed409e955fef722227f561","a07b36ebc60b4c588d7870c4adcd7757","7b1a928c35d64d61999169796d95b178","59bf5a3c9aa541d0a3a88ac68880c5b4","c138cb89049c4a2c87bed355da2ccf3d","f9a78f6d498f49f79322cf0ecd374bf0","59fda5e2256c4e2489b27af555710bfe","b80fe94d5af74272a9a36fd8149662a8","0db3e5859e2b4047b5c03d369821b3f4","f87d5b38ebe345a6905b61e73222de60","4f92eae8b15642b2a84c8b391d9b0d39","1498f049d2274780b83186a07e82fed6","77cf943557ba41079cc66b7986ed8ade","84fe917bb05e49c5b618c80b38973579","4fd359e5407045948f965ece72f499bc","1174b2cdf36f4bdbb092c58756b29b59","c21b62145dc44661b01dc155227480db","ac9c3205472548339004c21d7e899645","7ccdabbebbf44c7bbc3c73986940c16b","00515f80cdee4347ab1dc8cda9efe52d","5c92e3429f8b4ac19277b6bd1003d0e1","1bf10d404c8c4f6183958fbec8ed1d03","320d5c625c704dc89815e772409b4b95","579e56bf3afb4e8aa60dc262741643da","6e50d022302748828c3626f7cf970d3a","8d6e359c1ae74e97a2073283d0ce7407","7cf6622e557b4a2ab1bb9a37b6e0017c","aa1316443956406b980dff1f1553131e","5ff8502416404c17baa9dab137e2fd43","8fbad883a0b44695bf4a294ca913f83c","844c19358d7048dfb76607443d5d960b","80a35aa9490f48e98e38afeb2712008f","175e528b63b5448eaa69343a580f9a48","8a467bc5a5f041229ceb030b2ee69d52","e8d4fae94894451da732490f5e87abab","c0cc3e2c21084b81a02e9302c16d9375","31ef1070ce564dd0b6491a60030d10a0","8b4c6f9ff4e64d79aae4e845d205df6e","d7b8e6802645450d814d50bfe8914ca1","c8e6847b569941bf8f35cf1c46826058","a17c76d7cf3e4e3caf417f9f8050b68f","8366b2777c2744feb8c976d87c637bfb","386ed221cd3e499382d5ab49fe015370","7153f18f59ec4e15b847714d741ad2d6"]},"id":"hmLzhUPu371G","outputId":"51baca14-8ed4-4135-ca13-d7256c07b6e1","trusted":true,"execution":{"iopub.status.busy":"2025-07-11T08:38:26.172333Z","iopub.execute_input":"2025-07-11T08:38:26.173109Z","iopub.status.idle":"2025-07-11T08:39:40.004693Z","shell.execute_reply.started":"2025-07-11T08:38:26.173067Z","shell.execute_reply":"2025-07-11T08:39:40.004093Z"}},"outputs":[{"output_type":"display_data","data":{"text/plain":"tokenizer_config.json: 0.00B [00:00, ?B/s]","application/vnd.jupyter.widget-view+json":{"version_major":2,"version_minor":0,"model_id":"4aa84f3bfd114f359c74e036a9f41ee7"}},"metadata":{}},{"output_type":"display_data","data":{"text/plain":"vocab.json: 0.00B [00:00, ?B/s]","application/vnd.jupyter.widget-view+json":{"version_major":2,"version_minor":0,"model_id":"83efe9f64cd2433ca0b8a99ec4d8e053"}},"metadata":{}},{"output_type":"display_data","data":{"text/plain":"merges.txt: 0.00B [00:00, ?B/s]","application/vnd.jupyter.widget-view+json":{"version_major":2,"version_minor":0,"model_id":"6d5c760f92484909ac376d0c8fe3afb5"}},"metadata":{}},{"output_type":"display_data","data":{"text/plain":"tokenizer.json:   0%|          | 0.00/11.4M [00:00<?, ?B/s]","application/vnd.jupyter.widget-view+json":{"version_major":2,"version_minor":0,"model_id":"859ce431c7c546fb9cea5ce76c3b918a"}},"metadata":{}},{"output_type":"display_data","data":{"text/plain":"config.json:   0%|          | 0.00/726 [00:00<?, ?B/s]","application/vnd.jupyter.widget-view+json":{"version_major":2,"version_minor":0,"model_id":"be91baf1269340d9ba421a78d9bd29f9"}},"metadata":{}},{"output_type":"display_data","data":{"text/plain":"model.safetensors.index.json: 0.00B [00:00, ?B/s]","application/vnd.jupyter.widget-view+json":{"version_major":2,"version_minor":0,"model_id":"87cb84cf873849dfa7ecdf08864da1f3"}},"metadata":{}},{"output_type":"display_data","data":{"text/plain":"Fetching 3 files:   0%|          | 0/3 [00:00<?, ?it/s]","application/vnd.jupyter.widget-view+json":{"version_major":2,"version_minor":0,"model_id":"3c28841e399c4bf2a116fec105ec9325"}},"metadata":{}},{"output_type":"display_data","data":{"text/plain":"model-00002-of-00003.safetensors:   0%|          | 0.00/3.99G [00:00<?, ?B/s]","application/vnd.jupyter.widget-view+json":{"version_major":2,"version_minor":0,"model_id":"58a80219a95c4a33ae264c8df96adffc"}},"metadata":{}},{"output_type":"display_data","data":{"text/plain":"model-00001-of-00003.safetensors:   0%|          | 0.00/3.96G [00:00<?, ?B/s]","application/vnd.jupyter.widget-view+json":{"version_major":2,"version_minor":0,"model_id":"8ab21298d7634d01a586edecd2a5c750"}},"metadata":{}},{"output_type":"display_data","data":{"text/plain":"model-00003-of-00003.safetensors:   0%|          | 0.00/99.6M [00:00<?, ?B/s]","application/vnd.jupyter.widget-view+json":{"version_major":2,"version_minor":0,"model_id":"94b01c69b8a7408fbfbcf54502ac3a10"}},"metadata":{}},{"output_type":"display_data","data":{"text/plain":"Loading checkpoint shards:   0%|          | 0/3 [00:00<?, ?it/s]","application/vnd.jupyter.widget-view+json":{"version_major":2,"version_minor":0,"model_id":"ceb5d8e1e2724b6ba44fc3dd9b0f2c5f"}},"metadata":{}},{"output_type":"display_data","data":{"text/plain":"generation_config.json:   0%|          | 0.00/239 [00:00<?, ?B/s]","application/vnd.jupyter.widget-view+json":{"version_major":2,"version_minor":0,"model_id":"77c8fd81d8b844beb52ff6b586b5e6c0"}},"metadata":{}}],"execution_count":2},{"cell_type":"code","source":"# Prompt function\ndef chat(prompt, max_tokens=256, temperature=0.7):\n    # system_prompt = \"You are a concise assistant. Provide a single, short, and clear answer. Do not ask follow-up questions or provide additional, unnecessary information.\"\n    # prompt = f\"System: {system_prompt}\\nUser:{prompt}\"\n    prompt = prompt\n    inputs = tokenizer(prompt, return_tensors=\"pt\").to(model.device)\n    output_ids = model.generate(\n        **inputs,\n        max_new_tokens=max_tokens,\n        temperature=temperature,\n        do_sample=True,\n        top_p=0.95,\n        pad_token_id=tokenizer.eos_token_id\n    )\n    response = tokenizer.decode(output_ids[0][inputs['input_ids'].shape[-1]:], skip_special_tokens=True)\n    return response.strip()","metadata":{"id":"AT1Zq5Fj4AKf","trusted":true,"execution":{"iopub.status.busy":"2025-07-11T08:39:54.521153Z","iopub.execute_input":"2025-07-11T08:39:54.521761Z","iopub.status.idle":"2025-07-11T08:39:54.526348Z","shell.execute_reply.started":"2025-07-11T08:39:54.521737Z","shell.execute_reply":"2025-07-11T08:39:54.525613Z"}},"outputs":[],"execution_count":5},{"cell_type":"code","source":"def chat(user_prompt, max_tokens=1000, temperature=0.2):\n    \"\"\"\n    Interacts with the Qwen model, incorporating a system prompt for mathematical,\n    short, and precise answers.\n\n    Args:\n        user_prompt (str): The user's input query.\n        max_tokens (int): The maximum number of new tokens to generate for the response.\n                          Reduced for \"short and precise\" answers.\n        temperature (float): Controls the randomness of the generation. Lower values\n                             make the output more deterministic.\n\n    Returns:\n        str: The model's generated response.\n    \"\"\"\n    #system_prompt = \"You are a highly logical and precise mathematical assistant. When asked a question, analyze it rigorously, break it down into its mathematical components, and provide the shortest, most accurate answer possible. Focus on direct calculations, definitions, or theorems without unnecessary elaboration.\"\n    system_prompt = \"You are a highly logical and precise mathematical assistant. When asked a question, provide the shortest, most accurate answer possible. Focus on direct calculations, definitions, or theorems without unnecessary elaboration.\"\n    \n    messages = [\n        {\"role\": \"system\", \"content\": system_prompt},\n        {\"role\": \"user\", \"content\": user_prompt}\n    ]\n\n    # Apply the chat template to format the messages into a single prompt string\n    # add_generation_prompt=True is crucial for chat models like Qwen to start generating\n    formatted_prompt = tokenizer.apply_chat_template(messages, tokenize=False, add_generation_prompt=True)\n\n    inputs = tokenizer(formatted_prompt, return_tensors=\"pt\").to(model.device)\n\n    # Generate the response\n    output_ids = model.generate(\n        **inputs,\n        max_new_tokens=max_tokens,\n        temperature=temperature,\n        do_sample=True,\n        top_p=0.95,\n        pad_token_id=tokenizer.eos_token_id,\n        # It's often good practice to set eos_token_id in generate for better termination\n        eos_token_id=tokenizer.eos_token_id\n    )\n\n    # Decode the generated output, skipping the input part of the prompt\n    response = tokenizer.decode(output_ids[0][inputs['input_ids'].shape[-1]:], skip_special_tokens=True)\n    return response.strip()","metadata":{"trusted":true,"execution":{"iopub.status.busy":"2025-07-11T10:08:38.664335Z","iopub.execute_input":"2025-07-11T10:08:38.665067Z","iopub.status.idle":"2025-07-11T10:08:38.670744Z","shell.execute_reply.started":"2025-07-11T10:08:38.665040Z","shell.execute_reply":"2025-07-11T10:08:38.670104Z"}},"outputs":[],"execution_count":56},{"cell_type":"code","source":"import re\n\nlogging = False\n\ndef log(message, logging_once=False):\n  if logging or logging_once:\n    print(message)\n\ndef get_calc_prompt(problem)\n    # TODO: add more prompts in similar styles as the revised prompt\n    calc_prompt = f\"You will be given a math problem. The solution to the problem is an integer. Your task is to provide the solution. Only provide the final answer as an integer. Do not include any additional word or phrase. You final answer should start with 'FINAL ANSWER:'. Math problem: {problem}\",\n    return calc_prompt\n\ndef get_revise_prompt(problem)\n\n\ndef check_counterfactual(problem, correct_answer, revised_answer, revise_prompt_idx):\n  problem_prompt=f\"You will be given a math problem. The solution to the problem is an integer. Your task is to provide the solution. Only provide the final answer as an integer. Do not include any additional word or phrase. You final answer should start with 'FINAL ANSWER:'. Math problem: {problem}\",\n  revise_prompts = [\n      f\"You will be given a math problem. Your task is to revise the math problem so your final answer to the revised problem becomes {revised_answer}. Share only the revised Problem. The revised problem should start with 'REVISED PROBLEM:'.Math problem: {problem}\"\n      f\"Revise the given math problem so your final answer to the revised problem becomes {revised_answer}. Share only the revised Problem. The revised problem should start with 'REVISED PROBLEM:'. Math problem: {problem}\\n\"\n      f\"Modify the given math problem so its solution is {revised_answer}. Present only the revised problem, starting with 'REVISED PROBLEM:'. Math problem: {problem}\",\n      f\"You are tasked with altering the provided math problem. The revised problem must yield {revised_answer} as its solution. Output only the revised problem statement, ensuring it begins with 'REVISED PROBLEM:'. Math problem: {problem}\",\n      f\"Imagine you are a problem reviser. Your goal is to rewrite the math problem so that its new solution becomes {revised_answer}. Deliver only the revised problem, starting with 'REVISED PROBLEM:'. Math problem: {problem}\",\n      f\"Your task is to re-engineer the following math problem to produce {revised_answer} as its answer. The **only** text you should provide is the revised problem, which must start with 'REVISED PROBLEM:'. Math problem: {problem}\",\n      f\"Your task is to revise the math problem so the final answer to the revised problem becomes {revised_answer}.First, understand the problem, identify which variables need to change to get the desired result and return the revised problem. Share only the revised Problem. The revised problem should start with 'REVISED PROBLEM:'. Math problem: {problem}\"\n  ]\n  revise_prompt = revise_prompts[revise_prompt_idx]\n  log(\"+------------- Inital Problem -------------+\")\n  log(problem)\n  log(\"+---------------- Response ----------------+\")\n  problem_response = chat(problem_prompt)\n  initial_answer = extract_result(problem_response)\n  if initial_answer is not None and initial_answer == correct_answer:\n    log(\"✅ Correct answer (original problem)\")\n    log(\"+------------ Revised Problem -------------+\")\n    revised_problem_response = chat(revise_prompt)\n    #log(revised_problem_response)\n    extract_problem(revised_problem_response)\n\n    revised_problem_prompt = f\"You will be given a math problem. The solution to the problem is an integer. Your task is to provide the solution. Only provide the final answer as an integer. Do not include any additional word or phrase. You final answer should start with 'FINAL ANSWER:'. Math problem: {revised_problem_text}\"\n    log(\"+------------ Revised Answer --------------+\")\n    revised_problem_answer = chat(revised_problem_prompt)\n    #log(revised_problem_answer)\n\n    # Extract revised answer\n    extracted_revised_answer = None\n    match = re.search(r\"FINAL ANSWER:\\s*(\\d+)\", revised_problem_answer)\n    if match:\n        try:\n            extracted_revised_answer = int(match.group(1))\n        except ValueError:\n            extracted_revised_answer = None\n\n    if extracted_revised_answer is not None and extracted_revised_answer == revised_answer:\n      log(f\"Revised answer: {extracted_revised_answer}\")\n      log(\"✅ Correct answer (revised & original problem)\")\n      return True, 'CORRECT ANSWER'\n    else:\n      log(f\"Revised answer: {extracted_revised_answer}\")\n      log(\"❌ Wrong answer (revised problem)\")\n      return False, 'WRONG REVISED ANSWER'\n  else:\n    log(f\"Response: {problem_response}\")\n    log(f\"Initial answer: {initial_answer}\")\n    log(\"❌ Wrong answer (original problem)\")\n    return False, 'WRONG INTIAL ANSWER'\n  return False, 'UNKNOWN'","metadata":{"id":"aruj-34t4EB-","trusted":true,"execution":{"iopub.status.busy":"2025-07-11T08:40:00.391090Z","iopub.execute_input":"2025-07-11T08:40:00.391405Z","iopub.status.idle":"2025-07-11T08:40:00.402115Z","shell.execute_reply.started":"2025-07-11T08:40:00.391381Z","shell.execute_reply":"2025-07-11T08:40:00.401487Z"}},"outputs":[],"execution_count":6},{"cell_type":"code","source":"import pandas as pd\n\nsplits = {'train': 'main/train-00000-of-00001.parquet', 'test': 'main/test-00000-of-00001.parquet'}\ntest_ds = pd.read_parquet(\"hf://datasets/openai/gsm8k/\" + splits[\"test\"])","metadata":{"id":"Oi9vr0Zt4mxt","trusted":true,"execution":{"iopub.status.busy":"2025-07-11T08:40:10.691182Z","iopub.execute_input":"2025-07-11T08:40:10.692144Z","iopub.status.idle":"2025-07-11T08:40:16.240963Z","shell.execute_reply.started":"2025-07-11T08:40:10.692114Z","shell.execute_reply":"2025-07-11T08:40:16.240370Z"}},"outputs":[],"execution_count":7},{"cell_type":"code","source":"test_ds['question'][0]\ntest_ds['answer'][0]","metadata":{"colab":{"base_uri":"https://localhost:8080/","height":35},"id":"npdTJkdqAglQ","outputId":"08c33cf8-4ab3-440d-a1f1-f79667ab58de"},"outputs":[{"output_type":"execute_result","data":{"text/plain":["'Janet sells 16 - 3 - 4 = <<16-3-4=9>>9 duck eggs a day.\\nShe makes 9 * 2 = $<<9*2=18>>18 every day at the farmer’s market.\\n#### 18'"],"application/vnd.google.colaboratory.intrinsic+json":{"type":"string"}},"metadata":{},"execution_count":11}],"execution_count":11},{"cell_type":"code","source":"","metadata":{"id":"gLAFGKpx-OY-"},"outputs":[],"execution_count":6},{"cell_type":"markdown","source":"Load realistic values for generating counterfactuals","metadata":{"id":"njrAwOVQ4ynR"}},{"cell_type":"code","source":"counterfactuals = [20, 3, 77500, 720, 26, 60, 325, 150, 60, 472, 391.5, 685, 13, 25.5, 56.25, 150, 235, 61000, 9.33, 5.14, 15.6, 12, 10, 10, 27.86, 1.65, 324, 15, 23, 110, 112.32, 81.67, 42, 72.5, 24, 11.25, 87.5, 2, 9.23, 20, 8, 350, 34, 96, 23.30, 124.8, 158, 680, 10, 33.75, 303.34, 6.67, 16, 100, 47, 15, 3, 96.33, 63.25, 199, 21, 1485, 20000, 1710, 330, 42, 56, 615, 39, 55, 8550, 64, 227, 272, 97, 56.25, 4.91, 105, 6.68, 77, 10.66, 19, 648, 800, 15.5, 48, 27.5, 10140, 8181.82, 26, 270, 33, 5, 36.9, 378, 42, 3.33, 13.125, 7, 68]","metadata":{"id":"4CF0ew-G4xE1","trusted":true,"execution":{"iopub.status.busy":"2025-07-11T08:40:22.246296Z","iopub.execute_input":"2025-07-11T08:40:22.246628Z","iopub.status.idle":"2025-07-11T08:40:22.252831Z","shell.execute_reply.started":"2025-07-11T08:40:22.246598Z","shell.execute_reply":"2025-07-11T08:40:22.252131Z"}},"outputs":[],"execution_count":8},{"cell_type":"code","source":"import re\n\ndef extract_result(problem_response):\n    match = re.search(r\"FINAL ANSWER:\\s*(\\d+)\", problem_response)\n    if match:\n        try:\n            result = int(match.group(1))\n        except ValueError:\n            print(f'Error while converting to int {match.group(1)}')\n            result = None\n    else:\n        print(f'No result found: {problem_response}')\n        result = None\n    return result\n\ndef extract_problem(revised_problem_response):\n    revised_problem_text = \"\"\n    match = re.search(r\"(?:REVISED PROBLEM:)\\s*(.*?)(?:\\n\\s*\\n|\\Z)\", revised_problem_response, re.DOTALL)\n    if match:\n        revised_problem_text = match.group(1).strip()\n        return revised_problem_text\n    else:\n        print(f'No revised problem found in: {revised_problem_response}')\n        return None","metadata":{"trusted":true,"execution":{"iopub.status.busy":"2025-07-11T08:52:43.199562Z","iopub.execute_input":"2025-07-11T08:52:43.200395Z","iopub.status.idle":"2025-07-11T08:52:43.204835Z","shell.execute_reply.started":"2025-07-11T08:52:43.200368Z","shell.execute_reply":"2025-07-11T08:52:43.203944Z"}},"outputs":[],"execution_count":23},{"cell_type":"code","source":"","metadata":{"trusted":true,"execution":{"iopub.status.busy":"2025-07-11T09:55:12.145419Z","iopub.execute_input":"2025-07-11T09:55:12.146266Z","iopub.status.idle":"2025-07-11T09:55:12.150964Z","shell.execute_reply.started":"2025-07-11T09:55:12.146240Z","shell.execute_reply":"2025-07-11T09:55:12.150147Z"}},"outputs":[],"execution_count":51},{"cell_type":"code","source":"problem = \"Albert is wondering how much pizza he can eat in one day. He buys 2 large pizzas and 2 small pizzas. A large pizza has 16 slices and a small pizza has 8 slices. If he eats it all, how many pieces does he eat that day?\"\ninit_prompt = f\"You will be given a math problem. The solution to the problem is an integer. Your task is to provide the solution. Only provide the final answer as an integer. Do not include any additional word or phrase. You final answer should start with 'FINAL ANSWER:'. Math problem: {problem}\"\ninit_answer = chat(init_prompt)\nresult = extract_result(init_answer)\nprint(f\"Init result: {result}\")\nrevise_correct_answer = 50\nrevise_prompt = f\"Math problem: {problem}\\nNow, revise the math problem so your final answer to the revised problem becomes {revise_correct_answer}. Share only the first revised Problem, do not search for alternatives. The revised problem should start with 'REVISED PROBLEM:'\"\nrevised_problem_answer = chat(revise_prompt)\n#print(revised_problem_answer)\nrevised_problem = extract_problem(revised_problem_answer)\nprint(f\"Revised Problem: {revised_problem}\")\n#print(init_answer)\nrevised_problem_calculation = f\"You will be given a math problem. The solution to the problem is an integer. Your task is to provide the solution. Only provide the final answer as an integer. Do not include any additional word or phrase. You final answer should start with 'FINAL ANSWER: [integer]'. Math problem: {revised_problem}\"\nrevised_problem_calculation_answer = chat(revised_problem_calculation)\nrevised_result = extract_result(revised_problem_calculation_answer)\nprint(f\"Revised Problem Answer: {revised_result}\")\nif revised_result != revise_correct_answer:\n    print(revised_problem_calculation_answer)\n","metadata":{"trusted":true,"execution":{"iopub.status.busy":"2025-07-11T10:08:44.473099Z","iopub.execute_input":"2025-07-11T10:08:44.473419Z","iopub.status.idle":"2025-07-11T10:10:23.254018Z","shell.execute_reply.started":"2025-07-11T10:08:44.473397Z","shell.execute_reply":"2025-07-11T10:10:23.253366Z"}},"outputs":[{"name":"stdout","text":"Init result: 48\nRevised Problem: Albert buys 2 large pizzas and 2 small pizzas. A large pizza has 17 slices and a small pizza has 8 slices. If he eats it all, how many pieces does he eat that day?\nRevised Problem Answer: 50\n","output_type":"stream"}],"execution_count":57},{"cell_type":"code","source":"prompt_idx = 0\nfor idx in range(100):\n    question = test_ds['question'][idx]\n    answer = test_ds['answer'][idx]\n    answer_int = answer.split('####')[1]\n    # Remove thounsands divider\n    if ',' in answer_int:\n        answer_int = ''.join(digit for digit in answer_int.split(','))\n    answer_int = int(answer_int)\n    counterfactual_int = counterfactuals[idx]\n    result, reason = check_counterfactual(question, answer_int, answer_int, prompt_idx)\n    # if reason == 'WRONG INTIAL ANSWER':\n    #     # retry\n    #     result, reason = check_counterfactual(question, answer_int, answer_int, prompt_idx)\n    #     if reason == 'WRONG INTIAL ANSWER':\n    #       # retry 2 times\n    #       result, reason = check_counterfactual(question, answer_int, answer_int, prompt_idx)\n    print(f\"{idx:4} | {str(result):5} | {str(prompt_idx):5} | {reason}\")","metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"cE1dyvRY5y8Z","outputId":"567045d4-c4a0-44e8-edb2-679758105a3e","trusted":true,"execution":{"iopub.status.busy":"2025-07-11T08:40:28.402148Z","iopub.execute_input":"2025-07-11T08:40:28.402804Z","iopub.status.idle":"2025-07-11T08:43:29.716818Z","shell.execute_reply.started":"2025-07-11T08:40:28.402769Z","shell.execute_reply":"2025-07-11T08:43:29.715044Z"}},"outputs":[{"name":"stdout","text":"   0 | False | 0     | NO REVISED PROBLEM\n   1 | False | 0     | WRONG REVISED ANSWER\n   2 | False | 0     | NO REVISED PROBLEM\n   3 | False | 0     | WRONG INTIAL ANSWER\n   4 | False | 0     | WRONG INTIAL ANSWER\n","output_type":"stream"},{"traceback":["\u001b[0;31m---------------------------------------------------------------------------\u001b[0m","\u001b[0;31mKeyboardInterrupt\u001b[0m                         Traceback (most recent call last)","\u001b[0;32m/tmp/ipykernel_36/2846741333.py\u001b[0m in \u001b[0;36m<cell line: 0>\u001b[0;34m()\u001b[0m\n\u001b[1;32m      9\u001b[0m     \u001b[0manswer_int\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mint\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0manswer_int\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m     10\u001b[0m     \u001b[0mcounterfactual_int\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mcounterfactuals\u001b[0m\u001b[0;34m[\u001b[0m\u001b[0midx\u001b[0m\u001b[0;34m]\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m---> 11\u001b[0;31m     \u001b[0mresult\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mreason\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mcheck_counterfactual\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mquestion\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0manswer_int\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0manswer_int\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mprompt_idx\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m     12\u001b[0m     \u001b[0;31m# if reason == 'WRONG INTIAL ANSWER':\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m     13\u001b[0m     \u001b[0;31m#     # retry\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n","\u001b[0;32m/tmp/ipykernel_36/2232934232.py\u001b[0m in \u001b[0;36mcheck_counterfactual\u001b[0;34m(problem, correct_answer, revised_answer, revise_prompt_idx)\u001b[0m\n\u001b[1;32m     22\u001b[0m   \u001b[0mlog\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mproblem\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m     23\u001b[0m   \u001b[0mlog\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m\"+---------------- Response ----------------+\"\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m---> 24\u001b[0;31m   \u001b[0mproblem_response\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mchat\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mproblem_prompt\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m     25\u001b[0m   \u001b[0;31m# Extract initial answer\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m     26\u001b[0m   \u001b[0minitial_answer\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0;32mNone\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n","\u001b[0;32m/tmp/ipykernel_36/1050202198.py\u001b[0m in \u001b[0;36mchat\u001b[0;34m(prompt, max_tokens, temperature)\u001b[0m\n\u001b[1;32m      5\u001b[0m     \u001b[0mprompt\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mprompt\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m      6\u001b[0m     \u001b[0minputs\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mtokenizer\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mprompt\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mreturn_tensors\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0;34m\"pt\"\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mto\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mmodel\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mdevice\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m----> 7\u001b[0;31m     output_ids = model.generate(\n\u001b[0m\u001b[1;32m      8\u001b[0m         \u001b[0;34m**\u001b[0m\u001b[0minputs\u001b[0m\u001b[0;34m,\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m      9\u001b[0m         \u001b[0mmax_new_tokens\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0mmax_tokens\u001b[0m\u001b[0;34m,\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n","\u001b[0;32m/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py\u001b[0m in \u001b[0;36mdecorate_context\u001b[0;34m(*args, **kwargs)\u001b[0m\n\u001b[1;32m    114\u001b[0m     \u001b[0;32mdef\u001b[0m \u001b[0mdecorate_context\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m*\u001b[0m\u001b[0margs\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0;34m**\u001b[0m\u001b[0mkwargs\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    115\u001b[0m         \u001b[0;32mwith\u001b[0m \u001b[0mctx_factory\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m--> 116\u001b[0;31m             \u001b[0;32mreturn\u001b[0m \u001b[0mfunc\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m*\u001b[0m\u001b[0margs\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0;34m**\u001b[0m\u001b[0mkwargs\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m    117\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    118\u001b[0m     \u001b[0;32mreturn\u001b[0m \u001b[0mdecorate_context\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n","\u001b[0;32m/usr/local/lib/python3.11/dist-packages/transformers/generation/utils.py\u001b[0m in \u001b[0;36mgenerate\u001b[0;34m(self, inputs, generation_config, logits_processor, stopping_criteria, prefix_allowed_tokens_fn, synced_gpus, assistant_model, streamer, negative_prompt_ids, negative_prompt_attention_mask, use_model_defaults, custom_generate, **kwargs)\u001b[0m\n\u001b[1;32m   2595\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m   2596\u001b[0m             \u001b[0;31m# 12. run sample (it degenerates to greedy search when `generation_config.do_sample=False`)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m-> 2597\u001b[0;31m             result = self._sample(\n\u001b[0m\u001b[1;32m   2598\u001b[0m                 \u001b[0minput_ids\u001b[0m\u001b[0;34m,\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m   2599\u001b[0m                 \u001b[0mlogits_processor\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0mprepared_logits_processor\u001b[0m\u001b[0;34m,\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n","\u001b[0;32m/usr/local/lib/python3.11/dist-packages/transformers/generation/utils.py\u001b[0m in \u001b[0;36m_sample\u001b[0;34m(self, input_ids, logits_processor, stopping_criteria, generation_config, synced_gpus, streamer, **model_kwargs)\u001b[0m\n\u001b[1;32m   3558\u001b[0m                 \u001b[0mis_prefill\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0;32mFalse\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m   3559\u001b[0m             \u001b[0;32melse\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m-> 3560\u001b[0;31m                 \u001b[0moutputs\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mmodel_forward\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m**\u001b[0m\u001b[0mmodel_inputs\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mreturn_dict\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0;32mTrue\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m   3561\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m   3562\u001b[0m             \u001b[0;31m# synced_gpus: don't waste resources running the code we don't need; kwargs must be updated before skipping\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n","\u001b[0;32m/usr/local/lib/python3.11/dist-packages/torch/nn/modules/module.py\u001b[0m in \u001b[0;36m_wrapped_call_impl\u001b[0;34m(self, *args, **kwargs)\u001b[0m\n\u001b[1;32m   1737\u001b[0m             \u001b[0;32mreturn\u001b[0m \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0m_compiled_call_impl\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m*\u001b[0m\u001b[0margs\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0;34m**\u001b[0m\u001b[0mkwargs\u001b[0m\u001b[0;34m)\u001b[0m  \u001b[0;31m# type: ignore[misc]\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m   1738\u001b[0m         \u001b[0;32melse\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m-> 1739\u001b[0;31m             \u001b[0;32mreturn\u001b[0m \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0m_call_impl\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m*\u001b[0m\u001b[0margs\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0;34m**\u001b[0m\u001b[0mkwargs\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m   1740\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m   1741\u001b[0m     \u001b[0;31m# torchrec tests the code consistency with the following code\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n","\u001b[0;32m/usr/local/lib/python3.11/dist-packages/torch/nn/modules/module.py\u001b[0m in \u001b[0;36m_call_impl\u001b[0;34m(self, *args, **kwargs)\u001b[0m\n\u001b[1;32m   1748\u001b[0m                 \u001b[0;32mor\u001b[0m \u001b[0m_global_backward_pre_hooks\u001b[0m \u001b[0;32mor\u001b[0m \u001b[0m_global_backward_hooks\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m   1749\u001b[0m                 or _global_forward_hooks or _global_forward_pre_hooks):\n\u001b[0;32m-> 1750\u001b[0;31m             \u001b[0;32mreturn\u001b[0m \u001b[0mforward_call\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m*\u001b[0m\u001b[0margs\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0;34m**\u001b[0m\u001b[0mkwargs\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m   1751\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m   1752\u001b[0m         \u001b[0mresult\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0;32mNone\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n","\u001b[0;32m/usr/local/lib/python3.11/dist-packages/accelerate/hooks.py\u001b[0m in \u001b[0;36mnew_forward\u001b[0;34m(module, *args, **kwargs)\u001b[0m\n\u001b[1;32m    173\u001b[0m                 \u001b[0moutput\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mmodule\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0m_old_forward\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m*\u001b[0m\u001b[0margs\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0;34m**\u001b[0m\u001b[0mkwargs\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    174\u001b[0m         \u001b[0;32melse\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m--> 175\u001b[0;31m             \u001b[0moutput\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mmodule\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0m_old_forward\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m*\u001b[0m\u001b[0margs\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0;34m**\u001b[0m\u001b[0mkwargs\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m    176\u001b[0m         \u001b[0;32mreturn\u001b[0m \u001b[0mmodule\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0m_hf_hook\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mpost_forward\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mmodule\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0moutput\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    177\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n","\u001b[0;32m/usr/local/lib/python3.11/dist-packages/transformers/utils/generic.py\u001b[0m in \u001b[0;36mwrapper\u001b[0;34m(self, *args, **kwargs)\u001b[0m\n\u001b[1;32m    967\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    968\u001b[0m         \u001b[0;32mtry\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m--> 969\u001b[0;31m             \u001b[0moutput\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mfunc\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mself\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0;34m*\u001b[0m\u001b[0margs\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0;34m**\u001b[0m\u001b[0mkwargs\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m    970\u001b[0m             \u001b[0;32mif\u001b[0m \u001b[0mis_requested_to_return_tuple\u001b[0m \u001b[0;32mor\u001b[0m \u001b[0;34m(\u001b[0m\u001b[0mis_configured_to_return_tuple\u001b[0m \u001b[0;32mand\u001b[0m \u001b[0mis_top_level_module\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    971\u001b[0m                 \u001b[0moutput\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0moutput\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mto_tuple\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n","\u001b[0;32m/usr/local/lib/python3.11/dist-packages/transformers/models/qwen3/modeling_qwen3.py\u001b[0m in \u001b[0;36mforward\u001b[0;34m(self, input_ids, attention_mask, position_ids, past_key_values, inputs_embeds, labels, use_cache, output_attentions, output_hidden_states, cache_position, logits_to_keep, **kwargs)\u001b[0m\n\u001b[1;32m    728\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    729\u001b[0m         \u001b[0;31m# decoder outputs consists of (dec_features, layer_state, dec_hidden, dec_attn)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m--> 730\u001b[0;31m         outputs: BaseModelOutputWithPast = self.model(\n\u001b[0m\u001b[1;32m    731\u001b[0m             \u001b[0minput_ids\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0minput_ids\u001b[0m\u001b[0;34m,\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    732\u001b[0m             \u001b[0mattention_mask\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0mattention_mask\u001b[0m\u001b[0;34m,\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n","\u001b[0;32m/usr/local/lib/python3.11/dist-packages/torch/nn/modules/module.py\u001b[0m in \u001b[0;36m_wrapped_call_impl\u001b[0;34m(self, *args, **kwargs)\u001b[0m\n\u001b[1;32m   1737\u001b[0m             \u001b[0;32mreturn\u001b[0m \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0m_compiled_call_impl\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m*\u001b[0m\u001b[0margs\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0;34m**\u001b[0m\u001b[0mkwargs\u001b[0m\u001b[0;34m)\u001b[0m  \u001b[0;31m# type: ignore[misc]\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m   1738\u001b[0m         \u001b[0;32melse\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m-> 1739\u001b[0;31m             \u001b[0;32mreturn\u001b[0m \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0m_call_impl\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m*\u001b[0m\u001b[0margs\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0;34m**\u001b[0m\u001b[0mkwargs\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m   1740\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m   1741\u001b[0m     \u001b[0;31m# torchrec tests the code consistency with the following code\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n","\u001b[0;32m/usr/local/lib/python3.11/dist-packages/torch/nn/modules/module.py\u001b[0m in \u001b[0;36m_call_impl\u001b[0;34m(self, *args, **kwargs)\u001b[0m\n\u001b[1;32m   1748\u001b[0m                 \u001b[0;32mor\u001b[0m \u001b[0m_global_backward_pre_hooks\u001b[0m \u001b[0;32mor\u001b[0m \u001b[0m_global_backward_hooks\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m   1749\u001b[0m                 or _global_forward_hooks or _global_forward_pre_hooks):\n\u001b[0;32m-> 1750\u001b[0;31m             \u001b[0;32mreturn\u001b[0m \u001b[0mforward_call\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m*\u001b[0m\u001b[0margs\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0;34m**\u001b[0m\u001b[0mkwargs\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m   1751\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m   1752\u001b[0m         \u001b[0mresult\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0;32mNone\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n","\u001b[0;32m/usr/local/lib/python3.11/dist-packages/transformers/utils/generic.py\u001b[0m in \u001b[0;36mwrapper\u001b[0;34m(self, *args, **kwargs)\u001b[0m\n\u001b[1;32m    967\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    968\u001b[0m         \u001b[0;32mtry\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m--> 969\u001b[0;31m             \u001b[0moutput\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mfunc\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mself\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0;34m*\u001b[0m\u001b[0margs\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0;34m**\u001b[0m\u001b[0mkwargs\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m    970\u001b[0m             \u001b[0;32mif\u001b[0m \u001b[0mis_requested_to_return_tuple\u001b[0m \u001b[0;32mor\u001b[0m \u001b[0;34m(\u001b[0m\u001b[0mis_configured_to_return_tuple\u001b[0m \u001b[0;32mand\u001b[0m \u001b[0mis_top_level_module\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    971\u001b[0m                 \u001b[0moutput\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0moutput\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mto_tuple\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n","\u001b[0;32m/usr/local/lib/python3.11/dist-packages/transformers/models/qwen3/modeling_qwen3.py\u001b[0m in \u001b[0;36mforward\u001b[0;34m(self, input_ids, attention_mask, position_ids, past_key_values, inputs_embeds, use_cache, output_attentions, output_hidden_states, cache_position, **flash_attn_kwargs)\u001b[0m\n\u001b[1;32m    461\u001b[0m                 \u001b[0mall_hidden_states\u001b[0m \u001b[0;34m+=\u001b[0m \u001b[0;34m(\u001b[0m\u001b[0mhidden_states\u001b[0m\u001b[0;34m,\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    462\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m--> 463\u001b[0;31m             layer_outputs = decoder_layer(\n\u001b[0m\u001b[1;32m    464\u001b[0m                 \u001b[0mhidden_states\u001b[0m\u001b[0;34m,\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    465\u001b[0m                 \u001b[0mattention_mask\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0mcausal_mask\u001b[0m\u001b[0;34m,\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n","\u001b[0;32m/usr/local/lib/python3.11/dist-packages/transformers/modeling_layers.py\u001b[0m in \u001b[0;36m__call__\u001b[0;34m(self, *args, **kwargs)\u001b[0m\n\u001b[1;32m     46\u001b[0m         \u001b[0;32mif\u001b[0m \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mgradient_checkpointing\u001b[0m \u001b[0;32mand\u001b[0m \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mtraining\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m     47\u001b[0m             \u001b[0;32mreturn\u001b[0m \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0m_gradient_checkpointing_func\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mpartial\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0msuper\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0m__call__\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0;34m**\u001b[0m\u001b[0mkwargs\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0;34m*\u001b[0m\u001b[0margs\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m---> 48\u001b[0;31m         \u001b[0;32mreturn\u001b[0m \u001b[0msuper\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0m__call__\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m*\u001b[0m\u001b[0margs\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0;34m**\u001b[0m\u001b[0mkwargs\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m","\u001b[0;32m/usr/local/lib/python3.11/dist-packages/torch/nn/modules/module.py\u001b[0m in \u001b[0;36m_wrapped_call_impl\u001b[0;34m(self, *args, **kwargs)\u001b[0m\n\u001b[1;32m   1737\u001b[0m             \u001b[0;32mreturn\u001b[0m \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0m_compiled_call_impl\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m*\u001b[0m\u001b[0margs\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0;34m**\u001b[0m\u001b[0mkwargs\u001b[0m\u001b[0;34m)\u001b[0m  \u001b[0;31m# type: ignore[misc]\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m   1738\u001b[0m         \u001b[0;32melse\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m-> 1739\u001b[0;31m             \u001b[0;32mreturn\u001b[0m \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0m_call_impl\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m*\u001b[0m\u001b[0margs\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0;34m**\u001b[0m\u001b[0mkwargs\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m   1740\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m   1741\u001b[0m     \u001b[0;31m# torchrec tests the code consistency with the following code\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n","\u001b[0;32m/usr/local/lib/python3.11/dist-packages/torch/nn/modules/module.py\u001b[0m in \u001b[0;36m_call_impl\u001b[0;34m(self, *args, **kwargs)\u001b[0m\n\u001b[1;32m   1748\u001b[0m                 \u001b[0;32mor\u001b[0m \u001b[0m_global_backward_pre_hooks\u001b[0m \u001b[0;32mor\u001b[0m \u001b[0m_global_backward_hooks\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m   1749\u001b[0m                 or _global_forward_hooks or _global_forward_pre_hooks):\n\u001b[0;32m-> 1750\u001b[0;31m             \u001b[0;32mreturn\u001b[0m \u001b[0mforward_call\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m*\u001b[0m\u001b[0margs\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0;34m**\u001b[0m\u001b[0mkwargs\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m   1751\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m   1752\u001b[0m         \u001b[0mresult\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0;32mNone\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n","\u001b[0;32m/usr/local/lib/python3.11/dist-packages/accelerate/hooks.py\u001b[0m in \u001b[0;36mnew_forward\u001b[0;34m(module, *args, **kwargs)\u001b[0m\n\u001b[1;32m    173\u001b[0m                 \u001b[0moutput\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mmodule\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0m_old_forward\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m*\u001b[0m\u001b[0margs\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0;34m**\u001b[0m\u001b[0mkwargs\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    174\u001b[0m         \u001b[0;32melse\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m--> 175\u001b[0;31m             \u001b[0moutput\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mmodule\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0m_old_forward\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m*\u001b[0m\u001b[0margs\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0;34m**\u001b[0m\u001b[0mkwargs\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m    176\u001b[0m         \u001b[0;32mreturn\u001b[0m \u001b[0mmodule\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0m_hf_hook\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mpost_forward\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mmodule\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0moutput\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    177\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n","\u001b[0;32m/usr/local/lib/python3.11/dist-packages/transformers/models/qwen3/modeling_qwen3.py\u001b[0m in \u001b[0;36mforward\u001b[0;34m(self, hidden_states, attention_mask, position_ids, past_key_value, output_attentions, use_cache, cache_position, position_embeddings, **kwargs)\u001b[0m\n\u001b[1;32m    282\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    283\u001b[0m         \u001b[0;31m# Self Attention\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m--> 284\u001b[0;31m         hidden_states, self_attn_weights = self.self_attn(\n\u001b[0m\u001b[1;32m    285\u001b[0m             \u001b[0mhidden_states\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0mhidden_states\u001b[0m\u001b[0;34m,\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    286\u001b[0m             \u001b[0mattention_mask\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0mattention_mask\u001b[0m\u001b[0;34m,\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n","\u001b[0;32m/usr/local/lib/python3.11/dist-packages/torch/nn/modules/module.py\u001b[0m in \u001b[0;36m_wrapped_call_impl\u001b[0;34m(self, *args, **kwargs)\u001b[0m\n\u001b[1;32m   1737\u001b[0m             \u001b[0;32mreturn\u001b[0m \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0m_compiled_call_impl\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m*\u001b[0m\u001b[0margs\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0;34m**\u001b[0m\u001b[0mkwargs\u001b[0m\u001b[0;34m)\u001b[0m  \u001b[0;31m# type: ignore[misc]\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m   1738\u001b[0m         \u001b[0;32melse\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m-> 1739\u001b[0;31m             \u001b[0;32mreturn\u001b[0m \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0m_call_impl\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m*\u001b[0m\u001b[0margs\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0;34m**\u001b[0m\u001b[0mkwargs\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m   1740\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m   1741\u001b[0m     \u001b[0;31m# torchrec tests the code consistency with the following code\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n","\u001b[0;32m/usr/local/lib/python3.11/dist-packages/torch/nn/modules/module.py\u001b[0m in \u001b[0;36m_call_impl\u001b[0;34m(self, *args, **kwargs)\u001b[0m\n\u001b[1;32m   1748\u001b[0m                 \u001b[0;32mor\u001b[0m \u001b[0m_global_backward_pre_hooks\u001b[0m \u001b[0;32mor\u001b[0m \u001b[0m_global_backward_hooks\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m   1749\u001b[0m                 or _global_forward_hooks or _global_forward_pre_hooks):\n\u001b[0;32m-> 1750\u001b[0;31m             \u001b[0;32mreturn\u001b[0m \u001b[0mforward_call\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m*\u001b[0m\u001b[0margs\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0;34m**\u001b[0m\u001b[0mkwargs\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m   1751\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m   1752\u001b[0m         \u001b[0mresult\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0;32mNone\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n","\u001b[0;32m/usr/local/lib/python3.11/dist-packages/accelerate/hooks.py\u001b[0m in \u001b[0;36mnew_forward\u001b[0;34m(module, *args, **kwargs)\u001b[0m\n\u001b[1;32m    173\u001b[0m                 \u001b[0moutput\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mmodule\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0m_old_forward\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m*\u001b[0m\u001b[0margs\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0;34m**\u001b[0m\u001b[0mkwargs\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    174\u001b[0m         \u001b[0;32melse\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m--> 175\u001b[0;31m             \u001b[0moutput\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mmodule\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0m_old_forward\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m*\u001b[0m\u001b[0margs\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0;34m**\u001b[0m\u001b[0mkwargs\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m    176\u001b[0m         \u001b[0;32mreturn\u001b[0m \u001b[0mmodule\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0m_hf_hook\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mpost_forward\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mmodule\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0moutput\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    177\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n","\u001b[0;32m/usr/local/lib/python3.11/dist-packages/transformers/models/qwen3/modeling_qwen3.py\u001b[0m in \u001b[0;36mforward\u001b[0;34m(self, hidden_states, position_embeddings, attention_mask, past_key_value, cache_position, **kwargs)\u001b[0m\n\u001b[1;32m    211\u001b[0m         \u001b[0mhidden_shape\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0;34m(\u001b[0m\u001b[0;34m*\u001b[0m\u001b[0minput_shape\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0;34m-\u001b[0m\u001b[0;36m1\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mhead_dim\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    212\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m--> 213\u001b[0;31m         \u001b[0mquery_states\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mq_norm\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mq_proj\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mhidden_states\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mview\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mhidden_shape\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mtranspose\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;36m1\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0;36m2\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m    214\u001b[0m         \u001b[0mkey_states\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mk_norm\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mk_proj\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mhidden_states\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mview\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mhidden_shape\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mtranspose\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;36m1\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0;36m2\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    215\u001b[0m         \u001b[0mvalue_states\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mv_proj\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mhidden_states\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mview\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mhidden_shape\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mtranspose\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;36m1\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0;36m2\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n","\u001b[0;32m/usr/local/lib/python3.11/dist-packages/torch/nn/modules/module.py\u001b[0m in \u001b[0;36m_wrapped_call_impl\u001b[0;34m(self, *args, **kwargs)\u001b[0m\n\u001b[1;32m   1737\u001b[0m             \u001b[0;32mreturn\u001b[0m \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0m_compiled_call_impl\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m*\u001b[0m\u001b[0margs\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0;34m**\u001b[0m\u001b[0mkwargs\u001b[0m\u001b[0;34m)\u001b[0m  \u001b[0;31m# type: ignore[misc]\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m   1738\u001b[0m         \u001b[0;32melse\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m-> 1739\u001b[0;31m             \u001b[0;32mreturn\u001b[0m \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0m_call_impl\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m*\u001b[0m\u001b[0margs\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0;34m**\u001b[0m\u001b[0mkwargs\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m   1740\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m   1741\u001b[0m     \u001b[0;31m# torchrec tests the code consistency with the following code\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n","\u001b[0;32m/usr/local/lib/python3.11/dist-packages/torch/nn/modules/module.py\u001b[0m in \u001b[0;36m_call_impl\u001b[0;34m(self, *args, **kwargs)\u001b[0m\n\u001b[1;32m   1748\u001b[0m                 \u001b[0;32mor\u001b[0m \u001b[0m_global_backward_pre_hooks\u001b[0m \u001b[0;32mor\u001b[0m \u001b[0m_global_backward_hooks\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m   1749\u001b[0m                 or _global_forward_hooks or _global_forward_pre_hooks):\n\u001b[0;32m-> 1750\u001b[0;31m             \u001b[0;32mreturn\u001b[0m \u001b[0mforward_call\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m*\u001b[0m\u001b[0margs\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0;34m**\u001b[0m\u001b[0mkwargs\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m   1751\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m   1752\u001b[0m         \u001b[0mresult\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0;32mNone\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n","\u001b[0;32m/usr/local/lib/python3.11/dist-packages/accelerate/hooks.py\u001b[0m in \u001b[0;36mnew_forward\u001b[0;34m(module, *args, **kwargs)\u001b[0m\n\u001b[1;32m    173\u001b[0m                 \u001b[0moutput\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mmodule\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0m_old_forward\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m*\u001b[0m\u001b[0margs\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0;34m**\u001b[0m\u001b[0mkwargs\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    174\u001b[0m         \u001b[0;32melse\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m--> 175\u001b[0;31m             \u001b[0moutput\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mmodule\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0m_old_forward\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m*\u001b[0m\u001b[0margs\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0;34m**\u001b[0m\u001b[0mkwargs\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m    176\u001b[0m         \u001b[0;32mreturn\u001b[0m \u001b[0mmodule\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0m_hf_hook\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mpost_forward\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mmodule\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0moutput\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    177\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n","\u001b[0;32m/usr/local/lib/python3.11/dist-packages/transformers/models/qwen3/modeling_qwen3.py\u001b[0m in \u001b[0;36mforward\u001b[0;34m(self, hidden_states)\u001b[0m\n\u001b[1;32m     70\u001b[0m         \u001b[0mvariance\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mhidden_states\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mpow\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;36m2\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mmean\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m-\u001b[0m\u001b[0;36m1\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mkeepdim\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0;32mTrue\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m     71\u001b[0m         \u001b[0mhidden_states\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mhidden_states\u001b[0m \u001b[0;34m*\u001b[0m \u001b[0mtorch\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mrsqrt\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mvariance\u001b[0m \u001b[0;34m+\u001b[0m \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mvariance_epsilon\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m---> 72\u001b[0;31m         \u001b[0;32mreturn\u001b[0m \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mweight\u001b[0m \u001b[0;34m*\u001b[0m \u001b[0mhidden_states\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mto\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0minput_dtype\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m     73\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m     74\u001b[0m     \u001b[0;32mdef\u001b[0m \u001b[0mextra_repr\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mself\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n","\u001b[0;31mKeyboardInterrupt\u001b[0m: "],"ename":"KeyboardInterrupt","evalue":"","output_type":"error"}],"execution_count":9},{"cell_type":"code","source":"prompt_idx = 1\nresults__1 = []\nfor idx in range(100):\n    question = test_ds['question'][idx]\n    answer = test_ds['answer'][idx]\n    answer_int = answer.split('####')[1]\n    # Remove thounsands divider\n    if ',' in answer_int:\n        answer_int = ''.join(digit for digit in answer_int.split(','))\n    answer_int = int(answer_int)\n    counterfactual_int = counterfactuals[idx]\n    result, reason = check_counterfactual(question, answer_int, answer_int, prompt_idx)\n    # if reason == 'WRONG INTIAL ANSWER':\n    #     # retry\n    #     result, reason = check_counterfactual(question, answer_int, answer_int, prompt_idx)\n    #     if reason == 'WRONG INTIAL ANSWER':\n    #       # retry 2 times\n    #       result, reason = check_counterfactual(question, answer_int, answer_int, prompt_idx)\n    print(f\"{idx:4} | {str(result):5} | {str(prompt_idx):5} | {reason}\")","metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"76ac637f","outputId":"39b72982-245d-43ff-ce98-d3933e18f400"},"outputs":[{"output_type":"stream","name":"stdout","text":["   0 | False | 1     | WRONG INTIAL ANSWER\n","   1 | False | 1     | WRONG REVISED ANSWER\n","   2 | False | 1     | WRONG INTIAL ANSWER\n","   3 | False | 1     | WRONG REVISED ANSWER\n","   4 | False | 1     | WRONG INTIAL ANSWER\n","   5 | True  | 1     | CORRECT ANSWER\n","   6 | False | 1     | WRONG INTIAL ANSWER\n","   7 | False | 1     | WRONG INTIAL ANSWER\n","   8 | False | 1     | WRONG INTIAL ANSWER\n","   9 | False | 1     | WRONG INTIAL ANSWER\n","  10 | False | 1     | WRONG INTIAL ANSWER\n","  11 | False | 1     | WRONG INTIAL ANSWER\n","  12 | False | 1     | WRONG INTIAL ANSWER\n","  13 | False | 1     | WRONG INTIAL ANSWER\n","  14 | False | 1     | WRONG INTIAL ANSWER\n","  15 | False | 1     | WRONG INTIAL ANSWER\n","  16 | False | 1     | WRONG REVISED ANSWER\n","  17 | False | 1     | WRONG INTIAL ANSWER\n","  18 | False | 1     | WRONG REVISED ANSWER\n","  19 | False | 1     | WRONG INTIAL ANSWER\n","  20 | False | 1     | WRONG INTIAL ANSWER\n","  21 | False | 1     | WRONG INTIAL ANSWER\n","  22 | False | 1     | WRONG INTIAL ANSWER\n","  23 | True  | 1     | CORRECT ANSWER\n","  24 | True  | 1     | CORRECT ANSWER\n","  25 | False | 1     | WRONG INTIAL ANSWER\n","  26 | False | 1     | WRONG INTIAL ANSWER\n","  27 | False | 1     | WRONG INTIAL ANSWER\n","  28 | False | 1     | WRONG INTIAL ANSWER\n","  29 | False | 1     | WRONG REVISED ANSWER\n","  30 | False | 1     | WRONG INTIAL ANSWER\n","  31 | False | 1     | WRONG INTIAL ANSWER\n","  32 | False | 1     | WRONG REVISED ANSWER\n","  33 | False | 1     | WRONG INTIAL ANSWER\n","  34 | False | 1     | WRONG INTIAL ANSWER\n","  35 | False | 1     | WRONG INTIAL ANSWER\n","  36 | False | 1     | WRONG INTIAL ANSWER\n","  37 | False | 1     | WRONG INTIAL ANSWER\n","  38 | False | 1     | WRONG INTIAL ANSWER\n","  39 | False | 1     | WRONG INTIAL ANSWER\n","  40 | False | 1     | WRONG INTIAL ANSWER\n","  41 | False | 1     | WRONG INTIAL ANSWER\n","  42 | False | 1     | WRONG REVISED ANSWER\n","  43 | False | 1     | WRONG INTIAL ANSWER\n","  44 | False | 1     | WRONG INTIAL ANSWER\n","  45 | False | 1     | WRONG INTIAL ANSWER\n","  46 | False | 1     | WRONG INTIAL ANSWER\n","  47 | False | 1     | WRONG INTIAL ANSWER\n","  48 | False | 1     | WRONG REVISED ANSWER\n","  49 | False | 1     | WRONG INTIAL ANSWER\n","  50 | False | 1     | WRONG INTIAL ANSWER\n","  51 | False | 1     | WRONG REVISED ANSWER\n","  52 | False | 1     | WRONG INTIAL ANSWER\n","  53 | False | 1     | WRONG INTIAL ANSWER\n","  54 | False | 1     | WRONG INTIAL ANSWER\n","  55 | False | 1     | WRONG REVISED ANSWER\n","  56 | False | 1     | WRONG REVISED ANSWER\n","  57 | False | 1     | WRONG INTIAL ANSWER\n","  58 | False | 1     | WRONG INTIAL ANSWER\n","  59 | False | 1     | WRONG INTIAL ANSWER\n","  60 | False | 1     | WRONG INTIAL ANSWER\n","  61 | False | 1     | WRONG INTIAL ANSWER\n","  62 | False | 1     | WRONG INTIAL ANSWER\n","  63 | False | 1     | WRONG INTIAL ANSWER\n","  64 | False | 1     | WRONG INTIAL ANSWER\n","  65 | False | 1     | WRONG INTIAL ANSWER\n","  66 | False | 1     | WRONG INTIAL ANSWER\n","  67 | False | 1     | WRONG REVISED ANSWER\n","  68 | False | 1     | WRONG REVISED ANSWER\n","  69 | True  | 1     | CORRECT ANSWER\n","  70 | False | 1     | WRONG INTIAL ANSWER\n","  71 | False | 1     | WRONG REVISED ANSWER\n","  72 | False | 1     | WRONG REVISED ANSWER\n","  73 | False | 1     | WRONG INTIAL ANSWER\n","  74 | False | 1     | WRONG INTIAL ANSWER\n","  75 | False | 1     | WRONG INTIAL ANSWER\n","  76 | False | 1     | WRONG INTIAL ANSWER\n","  77 | False | 1     | WRONG INTIAL ANSWER\n","  78 | False | 1     | WRONG INTIAL ANSWER\n","  79 | False | 1     | WRONG REVISED ANSWER\n","  80 | False | 1     | WRONG REVISED ANSWER\n","  81 | False | 1     | WRONG REVISED ANSWER\n","  82 | False | 1     | WRONG INTIAL ANSWER\n","  83 | False | 1     | WRONG REVISED ANSWER\n","  84 | False | 1     | WRONG INTIAL ANSWER\n","  85 | False | 1     | WRONG REVISED ANSWER\n","  86 | False | 1     | WRONG INTIAL ANSWER\n","  87 | False | 1     | WRONG INTIAL ANSWER\n","  88 | False | 1     | WRONG INTIAL ANSWER\n","  89 | False | 1     | WRONG REVISED ANSWER\n","  90 | False | 1     | WRONG INTIAL ANSWER\n","  91 | False | 1     | WRONG INTIAL ANSWER\n","  92 | False | 1     | WRONG INTIAL ANSWER\n","  93 | False | 1     | WRONG INTIAL ANSWER\n","  94 | False | 1     | WRONG INTIAL ANSWER\n","  95 | False | 1     | WRONG INTIAL ANSWER\n","  96 | False | 1     | WRONG REVISED ANSWER\n","  97 | False | 1     | WRONG INTIAL ANSWER\n","  98 | False | 1     | WRONG REVISED ANSWER\n","  99 | False | 1     | WRONG INTIAL ANSWER\n"]}],"execution_count":21},{"cell_type":"code","source":"prompt_idx = 2\nfor idx in range(100):\n    question = test_ds['question'][idx]\n    answer = test_ds['answer'][idx]\n    answer_int = answer.split('####')[1]\n    # Remove thounsands divider\n    if ',' in answer_int:\n        answer_int = ''.join(digit for digit in answer_int.split(','))\n    answer_int = int(answer_int)\n    counterfactual_int = counterfactuals[idx]\n    result, reason = check_counterfactual(question, answer_int, answer_int, prompt_idx)\n    # if reason == 'WRONG INTIAL ANSWER':\n    #     # retry\n    #     result, reason = check_counterfactual(question, answer_int, answer_int, prompt_idx)\n    #     if reason == 'WRONG INTIAL ANSWER':\n    #       # retry 2 times\n    #       result, reason = check_counterfactual(question, answer_int, answer_int, prompt_idx)\n    print(f\"{idx:4} | {str(result):5} | {str(prompt_idx):5} | {reason}\")","metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"6IYhiLymROT-","outputId":"c2e0af8f-d535-4d3a-f356-21af08457ba3"},"outputs":[{"output_type":"stream","name":"stdout","text":["   0 | False | 2     | WRONG INTIAL ANSWER\n","   1 | False | 2     | WRONG REVISED ANSWER\n","   2 | False | 2     | WRONG INTIAL ANSWER\n","   3 | False | 2     | WRONG REVISED ANSWER\n","   4 | False | 2     | WRONG INTIAL ANSWER\n","   5 | False | 2     | WRONG INTIAL ANSWER\n","   6 | False | 2     | WRONG REVISED ANSWER\n","   7 | False | 2     | WRONG INTIAL ANSWER\n","   8 | False | 2     | WRONG INTIAL ANSWER\n","   9 | False | 2     | WRONG INTIAL ANSWER\n","  10 | False | 2     | WRONG INTIAL ANSWER\n","  11 | False | 2     | WRONG INTIAL ANSWER\n","  12 | False | 2     | WRONG INTIAL ANSWER\n","  13 | False | 2     | WRONG REVISED ANSWER\n","  14 | False | 2     | WRONG REVISED ANSWER\n","  15 | False | 2     | WRONG INTIAL ANSWER\n","  16 | False | 2     | WRONG REVISED ANSWER\n","  17 | False | 2     | WRONG INTIAL ANSWER\n","  18 | False | 2     | WRONG INTIAL ANSWER\n","  19 | False | 2     | WRONG INTIAL ANSWER\n","  20 | False | 2     | WRONG INTIAL ANSWER\n","  21 | False | 2     | WRONG INTIAL ANSWER\n","  22 | False | 2     | WRONG REVISED ANSWER\n","  23 | False | 2     | WRONG REVISED ANSWER\n","  24 | False | 2     | WRONG REVISED ANSWER\n","  25 | False | 2     | WRONG REVISED ANSWER\n","  26 | False | 2     | WRONG INTIAL ANSWER\n","  27 | False | 2     | WRONG INTIAL ANSWER\n","  28 | False | 2     | WRONG INTIAL ANSWER\n","  29 | False | 2     | WRONG INTIAL ANSWER\n","  30 | False | 2     | WRONG REVISED ANSWER\n","  31 | False | 2     | WRONG INTIAL ANSWER\n","  32 | False | 2     | WRONG REVISED ANSWER\n","  33 | False | 2     | WRONG INTIAL ANSWER\n","  34 | False | 2     | WRONG INTIAL ANSWER\n","  35 | False | 2     | WRONG INTIAL ANSWER\n","  36 | False | 2     | WRONG INTIAL ANSWER\n","  37 | False | 2     | WRONG INTIAL ANSWER\n","  38 | False | 2     | WRONG INTIAL ANSWER\n","  39 | False | 2     | WRONG INTIAL ANSWER\n","  40 | False | 2     | WRONG REVISED ANSWER\n","  41 | False | 2     | WRONG INTIAL ANSWER\n","  42 | False | 2     | WRONG REVISED ANSWER\n","  43 | False | 2     | WRONG INTIAL ANSWER\n","  44 | False | 2     | WRONG INTIAL ANSWER\n","  45 | False | 2     | WRONG INTIAL ANSWER\n","  46 | False | 2     | WRONG INTIAL ANSWER\n","  47 | False | 2     | WRONG INTIAL ANSWER\n","  48 | True  | 2     | CORRECT ANSWER\n","  49 | False | 2     | WRONG REVISED ANSWER\n","  50 | False | 2     | WRONG INTIAL ANSWER\n","  51 | False | 2     | WRONG INTIAL ANSWER\n","  52 | False | 2     | WRONG INTIAL ANSWER\n","  53 | False | 2     | WRONG INTIAL ANSWER\n","  54 | False | 2     | WRONG INTIAL ANSWER\n","  55 | True  | 2     | CORRECT ANSWER\n","  56 | False | 2     | WRONG REVISED ANSWER\n","  57 | False | 2     | WRONG INTIAL ANSWER\n","  58 | False | 2     | WRONG REVISED ANSWER\n","  59 | False | 2     | WRONG REVISED ANSWER\n","  60 | False | 2     | WRONG INTIAL ANSWER\n","  61 | False | 2     | WRONG INTIAL ANSWER\n","  62 | False | 2     | WRONG INTIAL ANSWER\n","  63 | False | 2     | WRONG INTIAL ANSWER\n","  64 | False | 2     | WRONG REVISED ANSWER\n","  65 | False | 2     | WRONG REVISED ANSWER\n","  66 | False | 2     | WRONG INTIAL ANSWER\n","  67 | False | 2     | WRONG INTIAL ANSWER\n","  68 | False | 2     | WRONG REVISED ANSWER\n","  69 | False | 2     | WRONG REVISED ANSWER\n","  70 | False | 2     | WRONG INTIAL ANSWER\n","  71 | False | 2     | WRONG REVISED ANSWER\n","  72 | False | 2     | WRONG INTIAL ANSWER\n","  73 | False | 2     | WRONG INTIAL ANSWER\n","  74 | False | 2     | WRONG INTIAL ANSWER\n","  75 | False | 2     | WRONG INTIAL ANSWER\n","  76 | False | 2     | WRONG INTIAL ANSWER\n","  77 | False | 2     | WRONG REVISED ANSWER\n","  78 | False | 2     | WRONG INTIAL ANSWER\n","  79 | False | 2     | WRONG REVISED ANSWER\n","  80 | False | 2     | WRONG INTIAL ANSWER\n","  81 | False | 2     | WRONG INTIAL ANSWER\n","  82 | False | 2     | WRONG REVISED ANSWER\n","  83 | False | 2     | WRONG REVISED ANSWER\n","  84 | False | 2     | WRONG INTIAL ANSWER\n","  85 | False | 2     | WRONG INTIAL ANSWER\n","  86 | False | 2     | WRONG INTIAL ANSWER\n","  87 | False | 2     | WRONG INTIAL ANSWER\n","  88 | False | 2     | WRONG INTIAL ANSWER\n","  89 | False | 2     | WRONG REVISED ANSWER\n","  90 | False | 2     | WRONG REVISED ANSWER\n","  91 | False | 2     | WRONG INTIAL ANSWER\n","  92 | False | 2     | WRONG REVISED ANSWER\n","  93 | False | 2     | WRONG INTIAL ANSWER\n","  94 | False | 2     | WRONG REVISED ANSWER\n","  95 | False | 2     | WRONG INTIAL ANSWER\n","  96 | False | 2     | WRONG INTIAL ANSWER\n","  97 | False | 2     | WRONG INTIAL ANSWER\n","  98 | False | 2     | WRONG INTIAL ANSWER\n","  99 | False | 2     | WRONG INTIAL ANSWER\n"]}],"execution_count":22},{"cell_type":"code","source":"prompt_idx = 3\nfor idx in range(100):\n    question = test_ds['question'][idx]\n    answer = test_ds['answer'][idx]\n    answer_int = answer.split('####')[1]\n    # Remove thounsands divider\n    if ',' in answer_int:\n        answer_int = ''.join(digit for digit in answer_int.split(','))\n    answer_int = int(answer_int)\n    counterfactual_int = counterfactuals[idx]\n    result, reason = check_counterfactual(question, answer_int, answer_int, prompt_idx)\n    # if reason == 'WRONG INTIAL ANSWER':\n    #     # retry\n    #     result, reason = check_counterfactual(question, answer_int, answer_int, prompt_idx)\n    #     if reason == 'WRONG INTIAL ANSWER':\n    #       # retry 2 times\n    #       result, reason = check_counterfactual(question, answer_int, answer_int, prompt_idx)\n    print(f\"{idx:4} | {str(result):5} | {str(prompt_idx):5} | {reason}\")","metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"TwS2F6xxRQZD","outputId":"ddca008a-8d32-4780-847f-b7a5b30d62a2"},"outputs":[{"output_type":"stream","name":"stdout","text":["   0 | False | 3     | WRONG INTIAL ANSWER\n","   1 | False | 3     | WRONG REVISED ANSWER\n","   2 | False | 3     | WRONG INTIAL ANSWER\n","   3 | False | 3     | WRONG INTIAL ANSWER\n","   4 | False | 3     | WRONG REVISED ANSWER\n","   5 | False | 3     | WRONG INTIAL ANSWER\n","   6 | False | 3     | WRONG INTIAL ANSWER\n","   7 | False | 3     | WRONG REVISED ANSWER\n","   8 | False | 3     | WRONG INTIAL ANSWER\n","   9 | False | 3     | WRONG REVISED ANSWER\n","  10 | False | 3     | WRONG INTIAL ANSWER\n","  11 | False | 3     | WRONG INTIAL ANSWER\n","  12 | False | 3     | WRONG INTIAL ANSWER\n","  13 | False | 3     | WRONG REVISED ANSWER\n","  14 | True  | 3     | CORRECT ANSWER\n","  15 | False | 3     | WRONG INTIAL ANSWER\n","  16 | False | 3     | WRONG REVISED ANSWER\n","  17 | False | 3     | WRONG INTIAL ANSWER\n","  18 | False | 3     | WRONG INTIAL ANSWER\n","  19 | False | 3     | WRONG INTIAL ANSWER\n","  20 | False | 3     | WRONG INTIAL ANSWER\n","  21 | False | 3     | WRONG INTIAL ANSWER\n","  22 | False | 3     | WRONG INTIAL ANSWER\n","  23 | False | 3     | WRONG REVISED ANSWER\n","  24 | False | 3     | WRONG REVISED ANSWER\n","  25 | False | 3     | WRONG REVISED ANSWER\n","  26 | True  | 3     | CORRECT ANSWER\n","  27 | False | 3     | WRONG INTIAL ANSWER\n","  28 | False | 3     | WRONG INTIAL ANSWER\n","  29 | False | 3     | WRONG REVISED ANSWER\n","  30 | False | 3     | WRONG INTIAL ANSWER\n","  31 | False | 3     | WRONG REVISED ANSWER\n","  32 | False | 3     | WRONG REVISED ANSWER\n","  33 | False | 3     | WRONG INTIAL ANSWER\n","  34 | False | 3     | WRONG REVISED ANSWER\n","  35 | False | 3     | WRONG INTIAL ANSWER\n","  36 | False | 3     | WRONG INTIAL ANSWER\n","  37 | False | 3     | WRONG INTIAL ANSWER\n","  38 | False | 3     | WRONG REVISED ANSWER\n","  39 | False | 3     | WRONG INTIAL ANSWER\n","  40 | False | 3     | WRONG REVISED ANSWER\n","  41 | False | 3     | WRONG REVISED ANSWER\n","  42 | False | 3     | WRONG REVISED ANSWER\n","  43 | False | 3     | WRONG INTIAL ANSWER\n","  44 | False | 3     | WRONG REVISED ANSWER\n","  45 | False | 3     | WRONG INTIAL ANSWER\n","  46 | False | 3     | WRONG INTIAL ANSWER\n","  47 | False | 3     | WRONG INTIAL ANSWER\n","  48 | False | 3     | WRONG REVISED ANSWER\n","  49 | False | 3     | WRONG REVISED ANSWER\n","  50 | False | 3     | WRONG INTIAL ANSWER\n","  51 | False | 3     | WRONG INTIAL ANSWER\n","  52 | False | 3     | WRONG INTIAL ANSWER\n","  53 | False | 3     | WRONG INTIAL ANSWER\n","  54 | False | 3     | WRONG INTIAL ANSWER\n","  55 | False | 3     | WRONG REVISED ANSWER\n","  56 | True  | 3     | CORRECT ANSWER\n","  57 | False | 3     | WRONG INTIAL ANSWER\n","  58 | False | 3     | WRONG INTIAL ANSWER\n","  59 | False | 3     | WRONG INTIAL ANSWER\n","  60 | False | 3     | WRONG INTIAL ANSWER\n","  61 | False | 3     | WRONG INTIAL ANSWER\n","  62 | False | 3     | WRONG INTIAL ANSWER\n","  63 | False | 3     | WRONG INTIAL ANSWER\n","  64 | False | 3     | WRONG INTIAL ANSWER\n","  65 | False | 3     | WRONG REVISED ANSWER\n","  66 | False | 3     | WRONG INTIAL ANSWER\n","  67 | False | 3     | WRONG INTIAL ANSWER\n","  68 | False | 3     | WRONG REVISED ANSWER\n","  69 | False | 3     | WRONG REVISED ANSWER\n","  70 | False | 3     | WRONG INTIAL ANSWER\n","  71 | False | 3     | WRONG REVISED ANSWER\n","  72 | False | 3     | WRONG INTIAL ANSWER\n","  73 | False | 3     | WRONG INTIAL ANSWER\n","  74 | False | 3     | WRONG INTIAL ANSWER\n","  75 | False | 3     | WRONG INTIAL ANSWER\n","  76 | False | 3     | WRONG INTIAL ANSWER\n","  77 | False | 3     | WRONG REVISED ANSWER\n","  78 | False | 3     | WRONG INTIAL ANSWER\n","  79 | False | 3     | WRONG REVISED ANSWER\n","  80 | False | 3     | WRONG INTIAL ANSWER\n","  81 | False | 3     | WRONG INTIAL ANSWER\n","  82 | False | 3     | WRONG INTIAL ANSWER\n","  83 | False | 3     | WRONG REVISED ANSWER\n","  84 | False | 3     | WRONG INTIAL ANSWER\n","  85 | True  | 3     | CORRECT ANSWER\n","  86 | False | 3     | WRONG INTIAL ANSWER\n","  87 | False | 3     | WRONG INTIAL ANSWER\n","  88 | False | 3     | WRONG INTIAL ANSWER\n","  89 | False | 3     | WRONG REVISED ANSWER\n","  90 | False | 3     | WRONG INTIAL ANSWER\n","  91 | False | 3     | WRONG INTIAL ANSWER\n","  92 | False | 3     | WRONG INTIAL ANSWER\n","  93 | False | 3     | WRONG INTIAL ANSWER\n","  94 | False | 3     | WRONG INTIAL ANSWER\n","  95 | False | 3     | WRONG INTIAL ANSWER\n","  96 | False | 3     | WRONG INTIAL ANSWER\n","  97 | False | 3     | WRONG INTIAL ANSWER\n","  98 | False | 3     | WRONG REVISED ANSWER\n","  99 | False | 3     | WRONG INTIAL ANSWER\n"]}],"execution_count":23},{"cell_type":"code","source":"prompt_idx = 4\nfor idx in range(100):\n    question = test_ds['question'][idx]\n    answer = test_ds['answer'][idx]\n    answer_int = answer.split('####')[1]\n    # Remove thounsands divider\n    if ',' in answer_int:\n        answer_int = ''.join(digit for digit in answer_int.split(','))\n    answer_int = int(answer_int)\n    counterfactual_int = counterfactuals[idx]\n    result, reason = check_counterfactual(question, answer_int, answer_int, prompt_idx)\n    # if reason == 'WRONG INTIAL ANSWER':\n    #     # retry\n    #     result, reason = check_counterfactual(question, answer_int, answer_int, prompt_idx)\n    #     if reason == 'WRONG INTIAL ANSWER':\n    #       # retry 2 times\n    #       result, reason = check_counterfactual(question, answer_int, answer_int, prompt_idx)\n    print(f\"{idx:4} | {str(result):5} | {str(prompt_idx):5} | {reason}\")","metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"U0oZDFdMRR92","outputId":"953e4206-8fa0-4f5b-c5c8-460854c1ef26"},"outputs":[{"output_type":"stream","name":"stdout","text":["   0 | False | 4     | WRONG INTIAL ANSWER\n","   1 | False | 4     | WRONG REVISED ANSWER\n","   2 | False | 4     | WRONG REVISED ANSWER\n","   3 | False | 4     | WRONG INTIAL ANSWER\n","   4 | False | 4     | WRONG INTIAL ANSWER\n","   5 | False | 4     | WRONG INTIAL ANSWER\n","   6 | False | 4     | WRONG REVISED ANSWER\n","   7 | False | 4     | WRONG INTIAL ANSWER\n","   8 | False | 4     | WRONG INTIAL ANSWER\n","   9 | False | 4     | WRONG INTIAL ANSWER\n","  10 | False | 4     | WRONG INTIAL ANSWER\n","  11 | False | 4     | WRONG INTIAL ANSWER\n","  12 | False | 4     | WRONG INTIAL ANSWER\n","  13 | False | 4     | WRONG INTIAL ANSWER\n","  14 | False | 4     | WRONG INTIAL ANSWER\n","  15 | False | 4     | WRONG INTIAL ANSWER\n","  16 | True  | 4     | CORRECT ANSWER\n","  17 | False | 4     | WRONG INTIAL ANSWER\n","  18 | False | 4     | WRONG INTIAL ANSWER\n","  19 | False | 4     | WRONG INTIAL ANSWER\n","  20 | False | 4     | WRONG INTIAL ANSWER\n","  21 | False | 4     | WRONG INTIAL ANSWER\n","  22 | False | 4     | WRONG REVISED ANSWER\n","  23 | True  | 4     | CORRECT ANSWER\n","  24 | False | 4     | WRONG REVISED ANSWER\n","  25 | False | 4     | WRONG INTIAL ANSWER\n","  26 | False | 4     | WRONG INTIAL ANSWER\n","  27 | False | 4     | WRONG INTIAL ANSWER\n","  28 | False | 4     | WRONG INTIAL ANSWER\n","  29 | False | 4     | WRONG INTIAL ANSWER\n","  30 | False | 4     | WRONG INTIAL ANSWER\n","  31 | False | 4     | WRONG INTIAL ANSWER\n","  32 | False | 4     | WRONG REVISED ANSWER\n","  33 | False | 4     | WRONG REVISED ANSWER\n","  34 | False | 4     | WRONG REVISED ANSWER\n","  35 | False | 4     | WRONG REVISED ANSWER\n","  36 | False | 4     | WRONG INTIAL ANSWER\n","  37 | False | 4     | WRONG INTIAL ANSWER\n","  38 | False | 4     | WRONG INTIAL ANSWER\n","  39 | False | 4     | WRONG REVISED ANSWER\n","  40 | False | 4     | WRONG REVISED ANSWER\n","  41 | False | 4     | WRONG INTIAL ANSWER\n","  42 | False | 4     | WRONG INTIAL ANSWER\n","  43 | False | 4     | WRONG INTIAL ANSWER\n","  44 | False | 4     | WRONG INTIAL ANSWER\n","  45 | False | 4     | WRONG INTIAL ANSWER\n","  46 | False | 4     | WRONG INTIAL ANSWER\n","  47 | False | 4     | WRONG INTIAL ANSWER\n","  48 | False | 4     | WRONG REVISED ANSWER\n","  49 | False | 4     | WRONG INTIAL ANSWER\n","  50 | False | 4     | WRONG INTIAL ANSWER\n","  51 | False | 4     | WRONG INTIAL ANSWER\n","  52 | False | 4     | WRONG REVISED ANSWER\n","  53 | False | 4     | WRONG INTIAL ANSWER\n","  54 | False | 4     | WRONG INTIAL ANSWER\n","  55 | False | 4     | WRONG REVISED ANSWER\n","  56 | True  | 4     | CORRECT ANSWER\n","  57 | False | 4     | WRONG INTIAL ANSWER\n","  58 | False | 4     | WRONG INTIAL ANSWER\n","  59 | False | 4     | WRONG REVISED ANSWER\n","  60 | False | 4     | WRONG INTIAL ANSWER\n","  61 | False | 4     | WRONG INTIAL ANSWER\n","  62 | False | 4     | WRONG INTIAL ANSWER\n","  63 | False | 4     | WRONG INTIAL ANSWER\n","  64 | False | 4     | WRONG INTIAL ANSWER\n","  65 | False | 4     | WRONG INTIAL ANSWER\n","  66 | False | 4     | WRONG INTIAL ANSWER\n","  67 | False | 4     | WRONG INTIAL ANSWER\n","  68 | False | 4     | WRONG INTIAL ANSWER\n","  69 | False | 4     | WRONG REVISED ANSWER\n","  70 | False | 4     | WRONG INTIAL ANSWER\n","  71 | False | 4     | WRONG REVISED ANSWER\n","  72 | False | 4     | WRONG INTIAL ANSWER\n","  73 | False | 4     | WRONG INTIAL ANSWER\n","  74 | False | 4     | WRONG INTIAL ANSWER\n","  75 | False | 4     | WRONG INTIAL ANSWER\n","  76 | False | 4     | WRONG INTIAL ANSWER\n","  77 | False | 4     | WRONG INTIAL ANSWER\n","  78 | False | 4     | WRONG INTIAL ANSWER\n","  79 | True  | 4     | CORRECT ANSWER\n","  80 | False | 4     | WRONG INTIAL ANSWER\n","  81 | False | 4     | WRONG INTIAL ANSWER\n","  82 | False | 4     | WRONG INTIAL ANSWER\n","  83 | False | 4     | WRONG REVISED ANSWER\n","  84 | False | 4     | WRONG INTIAL ANSWER\n","  85 | False | 4     | WRONG INTIAL ANSWER\n","  86 | False | 4     | WRONG INTIAL ANSWER\n","  87 | False | 4     | WRONG INTIAL ANSWER\n","  88 | False | 4     | WRONG REVISED ANSWER\n","  89 | False | 4     | WRONG INTIAL ANSWER\n","  90 | False | 4     | WRONG REVISED ANSWER\n","  91 | False | 4     | WRONG REVISED ANSWER\n","  92 | False | 4     | WRONG INTIAL ANSWER\n","  93 | False | 4     | WRONG INTIAL ANSWER\n","  94 | False | 4     | WRONG INTIAL ANSWER\n","  95 | False | 4     | WRONG INTIAL ANSWER\n","  96 | False | 4     | WRONG INTIAL ANSWER\n","  97 | False | 4     | WRONG INTIAL ANSWER\n","  98 | False | 4     | WRONG INTIAL ANSWER\n","  99 | True  | 4     | CORRECT ANSWER\n"]}],"execution_count":24},{"cell_type":"code","source":"prompt_idx = 5\nfor idx in range(100):\n    question = test_ds['question'][idx]\n    answer = test_ds['answer'][idx]\n    answer_int = answer.split('####')[1]\n    # Remove thounsands divider\n    if ',' in answer_int:\n        answer_int = ''.join(digit for digit in answer_int.split(','))\n    answer_int = int(answer_int)\n    counterfactual_int = counterfactuals[idx]\n    result, reason = check_counterfactual(question, answer_int, answer_int, prompt_idx)\n    # if reason == 'WRONG INTIAL ANSWER':\n    #     # retry\n    #     result, reason = check_counterfactual(question, answer_int, answer_int, prompt_idx)\n    #     if reason == 'WRONG INTIAL ANSWER':\n    #       # retry 2 times\n    #       result, reason = check_counterfactual(question, answer_int, answer_int, prompt_idx)\n    print(f\"{idx:4} | {str(result):5} | {str(prompt_idx):5} | {reason}\")","metadata":{"colab":{"base_uri":"https://localhost:8080/","height":367},"id":"Fzw1pCWYRTbY","outputId":"f4834aa0-58ee-417e-fb2b-08c5444ed63c"},"outputs":[{"output_type":"error","ename":"IndexError","evalue":"list index out of range","traceback":["\u001b[0;31m---------------------------------------------------------------------------\u001b[0m","\u001b[0;31mIndexError\u001b[0m                                Traceback (most recent call last)","\u001b[0;32m/tmp/ipython-input-25-2945061529.py\u001b[0m in \u001b[0;36m<cell line: 0>\u001b[0;34m()\u001b[0m\n\u001b[1;32m      9\u001b[0m     \u001b[0manswer_int\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mint\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0manswer_int\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m     10\u001b[0m     \u001b[0mcounterfactual_int\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mcounterfactuals\u001b[0m\u001b[0;34m[\u001b[0m\u001b[0midx\u001b[0m\u001b[0;34m]\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m---> 11\u001b[0;31m     \u001b[0mresult\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mreason\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mcheck_counterfactual\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mquestion\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0manswer_int\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0manswer_int\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mprompt_idx\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m     12\u001b[0m     \u001b[0;31m# if reason == 'WRONG INTIAL ANSWER':\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m     13\u001b[0m     \u001b[0;31m#     # retry\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n","\u001b[0;32m/tmp/ipython-input-19-3208766365.py\u001b[0m in \u001b[0;36mcheck_counterfactual\u001b[0;34m(problem, correct_answer, revised_answer, revise_prompt_idx)\u001b[0m\n\u001b[1;32m     18\u001b[0m       \u001b[0;34mf\"Your task is to revise the math problem so the final answer to the revised problem becomes {revised_answer}.First, understand the problem, identify which variables need to change to get the desired result and return the revised problem. Share only the revised Problem. The revised problem should start with 'REVISED PROBLEM:'. Math problem: {problem}\"\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m     19\u001b[0m   ]\n\u001b[0;32m---> 20\u001b[0;31m   \u001b[0mrevise_prompt\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mrevise_prompts\u001b[0m\u001b[0;34m[\u001b[0m\u001b[0mrevise_prompt_idx\u001b[0m\u001b[0;34m]\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m     21\u001b[0m   \u001b[0mlog\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m\"+------------- Inital Problem -------------+\"\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m     22\u001b[0m   \u001b[0mlog\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mproblem\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n","\u001b[0;31mIndexError\u001b[0m: list index out of range"]}],"execution_count":25},{"cell_type":"code","source":"prompt_idx = 6\nfor idx in range(100):\n    question = test_ds['question'][idx]\n    answer = test_ds['answer'][idx]\n    answer_int = answer.split('####')[1]\n    # Remove thounsands divider\n    if ',' in answer_int:\n        answer_int = ''.join(digit for digit in answer_int.split(','))\n    answer_int = int(answer_int)\n    counterfactual_int = counterfactuals[idx]\n    result, reason = check_counterfactual(question, answer_int, answer_int, prompt_idx)\n    # if reason == 'WRONG INTIAL ANSWER':\n    #     # retry\n    #     result, reason = check_counterfactual(question, answer_int, answer_int, prompt_idx)\n    #     if reason == 'WRONG INTIAL ANSWER':\n    #       # retry 2 times\n    #       result, reason = check_counterfactual(question, answer_int, answer_int, prompt_idx)\n    print(f\"{idx:4} | {str(result):5} | {str(prompt_idx):5} | {reason}\")","metadata":{"id":"PJ_k2B_QRZWv"},"outputs":[],"execution_count":null}]}